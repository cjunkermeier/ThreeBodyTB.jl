<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Additional Docstrings · ThreeBodyTB.jl Documentation</title><meta name="title" content="Additional Docstrings · ThreeBodyTB.jl Documentation"/><meta property="og:title" content="Additional Docstrings · ThreeBodyTB.jl Documentation"/><meta property="twitter:title" content="Additional Docstrings · ThreeBodyTB.jl Documentation"/><meta name="description" content="Documentation for ThreeBodyTB.jl Documentation."/><meta property="og:description" content="Documentation for ThreeBodyTB.jl Documentation."/><meta property="twitter:description" content="Documentation for ThreeBodyTB.jl Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/nist-combined.css" rel="stylesheet" type="text/css"/>      <link rel="stylesheet" href="../assets/nist-combined.css"> <script src="../assets/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script><script src="../assets/nist-header-footer.js" type="text/javascript" defer="defer"></script><script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ThreeBodyTB.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ThreeBodyTB.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../ug_run/">Running Calculations</a></li><li><a class="tocitem" href="../ug_fit/">Fit Coefficients</a></li></ul></li><li><span class="tocitem">Core User Interface</span><ul><li><a class="tocitem" href="../structs/">Structs</a></li><li><a class="tocitem" href="../core/">Functions</a></li></ul></li><li><a class="tocitem" href="../compile/">Compile/Python</a></li><li class="is-active"><a class="tocitem" href>Additional Docstrings</a><ul class="internal"><li><a class="tocitem" href="#ThreeBodyTB"><span>ThreeBodyTB</span></a></li><li><a class="tocitem" href="#TB"><span>TB</span></a></li><li><a class="tocitem" href="#AtomicProj"><span>AtomicProj</span></a></li><li><a class="tocitem" href="#BandStruct"><span>BandStruct</span></a></li><li><a class="tocitem" href="#DOS"><span>DOS</span></a></li><li><a class="tocitem" href="#Atomdata"><span>Atomdata</span></a></li><li><a class="tocitem" href="#AtomicMod"><span>AtomicMod</span></a></li><li><a class="tocitem" href="#BandTools"><span>BandTools</span></a></li><li><a class="tocitem" href="#CalcTB"><span>CalcTB</span></a></li><li><a class="tocitem" href="#CrystalMod"><span>CrystalMod</span></a></li><li><a class="tocitem" href="#DFToutMod"><span>DFToutMod</span></a></li><li><a class="tocitem" href="#DFT"><span>DFT</span></a></li><li><a class="tocitem" href="#QE"><span>QE</span></a></li><li><a class="tocitem" href="#Ewald"><span>Ewald</span></a></li><li><a class="tocitem" href="#FitTB"><span>FitTB</span></a></li><li><a class="tocitem" href="#Force_Stress"><span>Force_Stress</span></a></li><li><a class="tocitem" href="#ManageDatabase"><span>ManageDatabase</span></a></li><li><a class="tocitem" href="#SCF"><span>SCF</span></a></li><li><a class="tocitem" href="#Utilty"><span>Utilty</span></a></li><li><a class="tocitem" href="#Symmetry"><span>Symmetry</span></a></li><li><a class="tocitem" href="#Classical"><span>Classical</span></a></li><li><a class="tocitem" href="#ClassicalFit"><span>ClassicalFit</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Additional Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Additional Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/usnistgov/ThreeBodyTB.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/master/docs/src/every.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="ThreeBodyTB"><a class="docs-heading-anchor" href="#ThreeBodyTB">ThreeBodyTB</a><a id="ThreeBodyTB-1"></a><a class="docs-heading-anchor-permalink" href="#ThreeBodyTB" title="Permalink"></a></h2><h2 id="TB"><a class="docs-heading-anchor" href="#TB">TB</a><a id="TB-1"></a><a class="docs-heading-anchor-permalink" href="#TB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.tb_k" href="#ThreeBodyTB.TB.tb_k"><code>ThreeBodyTB.TB.tb_k</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">    mutable struct tb_k{T}

Tight binding object in k-space. Can be from direct import of DFT band
structure using atomic proj, or from fft&#39;ed tb object. Similar to real-space version.

# Holds
- `Hk::Array{Complex{T},4}` Hamiltonian in k-space
- `K::Array{Float64,2}` K point array. In fractional coordinates of BZ.
- `kweights::Array{Float64,1}` K point weights.
- `k_dict::Dict` Dictionary from k-point like [0,0,0] to index.
- `nwan::Int64` Number of orbitals / generalized wannier functions.
- `nk::Int64` Number of k-points.
- `nspin::Int64` Number of spins (2=magnetic)
- `nonorth::Bool` 
- `Sk::Array{Complex{T},3}` Overlap matrix.
- `scf::Bool` needs self-consistency?
- `h1::Array{T,3} #scf term` holds scf term if present
- `grid::Array{Int64,1}` dimensions of k-point grid, from regular grid like `[8,8,8]`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L207-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.tb_crys_kspace" href="#ThreeBodyTB.TB.tb_crys_kspace"><code>ThreeBodyTB.TB.tb_crys_kspace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">   mutable struct tb_crys_kspace{T}

Hold k-point tight binding and crystal structure. Similar to `tb_crys`

# Holds
- `tb::tb_k`
- `crys::crystal`
- `nelec::Float64`
- `nspin::Int64`
- `dftenergy::Float64`
- `scf::Bool`
- `gamma::Array{T, 2}`
- `eden::Array{Float64,2}`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L265-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.read_tb_crys_kspace" href="#ThreeBodyTB.TB.read_tb_crys_kspace"><code>ThreeBodyTB.TB.read_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function read_tb_crys_kspace(filename; directory=missing)</code></pre><p>Reads and returns from <code>filename</code> a <code>tb_crys_kspace</code> object. See <code>write_tb_crys_kspace</code></p><p>If cannot find <code>&quot;filename&quot;</code>, will look for <code>&quot;filename.xml&quot;</code>, <code>&quot;filename.gz&quot;</code>, <code>&quot;filename.xml.gz&quot;</code></p><p>Can read gzipped files directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L556-L566">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.write_tb_crys_kspace" href="#ThreeBodyTB.TB.write_tb_crys_kspace"><code>ThreeBodyTB.TB.write_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function write_tb_crys_kspace(filename, tbc::tb_crys_kspace)</code></pre><p>Save a <code>tb_crys_kspace</code> object to xml format. See <code>read_tb_crys_kspace</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L900-L904">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_crys" href="#ThreeBodyTB.TB.make_tb_crys"><code>ThreeBodyTB.TB.make_tb_crys</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">    function make_tb_crys(ham::tb,crys::crystal, nelec::Float64, dftenergy::Float64; scf=false, eden = missing, gamma=missing, within_fit=true, screening=1.0, tb_energy=-999, fermi_energy=0.0 )

Constructor function for `tb_crys` object</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1011-L1015">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_crys_kspace" href="#ThreeBodyTB.TB.make_tb_crys_kspace"><code>ThreeBodyTB.TB.make_tb_crys_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">    function make_tb_crys_kspace(hamk::tb_k,crys::crystal, nelec::Float64, dftenergy::Float64; scf=false, eden = missing, gamma=missing, screening=1.0)

Constructor function for `tb_crys_kspace` object</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1054-L1058">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb" href="#ThreeBodyTB.TB.make_tb"><code>ThreeBodyTB.TB.make_tb</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function make_tb(H, ind_arr, r_dict::Dict; h1=missing)</code></pre><p>Constructor function for <code>tb</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1099-L1103">source</a></section><section><div><pre><code class="language-julia hljs">function make_tb(H, ind_arr, r_dict::Dict, S; h1=missing)</code></pre><p>Constructor function for <code>tb</code> with overlaps</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1140-L1144">source</a></section><section><div><pre><code class="language-julia hljs">function make_tb(H, ind_arr, S; h1=missing)</code></pre><p>Constructor function for <code>tb</code>, better programming.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1266-L1270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.make_tb_k" href="#ThreeBodyTB.TB.make_tb_k"><code>ThreeBodyTB.TB.make_tb_k</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function make_tb_k(Hk, K, kweights, Sk; h1=missing, grid=[0,0,0], nonorth=true)</code></pre><p>Constructor for <code>tb_kspace</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1190-L1194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.load_hr_dat" href="#ThreeBodyTB.TB.load_hr_dat"><code>ThreeBodyTB.TB.load_hr_dat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function load_hr_dat(filename, directory=&quot;&quot;)</code></pre><p>Load a wannier90 hr.dat file Not currently a major part of program, but you can use if you want.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L1441-L1446">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy_fft" href="#ThreeBodyTB.TB.calc_energy_fft"><code>ThreeBodyTB.TB.calc_energy_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_energy_fft(tbc::tb_crys; grid=missing, smearing=0.01, return_more_info=false)</code></pre><p>Get energy using fft.</p><p>returns energy</p><p>if <code>return_more_info==true</code> then returns <code>etot, efermi, vals, vects</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L2018-L2028">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy_charge_fft" href="#ThreeBodyTB.TB.calc_energy_charge_fft"><code>ThreeBodyTB.TB.calc_energy_charge_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_energy_charge_fft(tbc::tb_crys; grid=missing, smearing=0.01)</code></pre><p>Do fft, then calculate energy and charge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L2938-L2942">source</a></section><section><div><pre><code class="language-julia hljs">     function calc_energy_charge_fft(tbc::tb_crys_sparse; grid=missing, smearing=0.01)</code></pre><p>Sparse matrix non-scf energy/eigenvectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB_sparse.jl#L684-L688">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.calc_energy" href="#ThreeBodyTB.TB.calc_energy"><code>ThreeBodyTB.TB.calc_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_energy(tbc::tb_crys; smearing=0.01, returnk=false)</code></pre><p>Calculate energy without fft.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3067-L3071">source</a></section><section><div><pre><code class="language-julia hljs">function calc_energy(h::tb_crys, kgrid; smearing=0.01, returnk=false)</code></pre><p>Calculate energy no fft</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3124-L3128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.types_energy" href="#ThreeBodyTB.TB.types_energy"><code>ThreeBodyTB.TB.types_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function types_energy(tbc::tb_crys)</code></pre><p>Calculate the reference energy of each atom in crystal. This results in the  total energy being indexed to seperated non-spin-polarized atoms. This is arbirary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3082-L3087">source</a></section><section><div><pre><code class="language-julia hljs">function types_energy(tbc::tb_crys)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3094-L3096">source</a></section><section><div><pre><code class="language-julia hljs">function types_energy(c::crystal)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3103-L3105">source</a></section><section><div><pre><code class="language-julia hljs">function types_energy(types)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3111-L3113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.make_kgrid" href="#ThreeBodyTB.TB.make_kgrid"><code>ThreeBodyTB.TB.make_kgrid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function make_kgrid(kgrid)</code></pre><p>-<code>kgrid</code> is an array of 3 integers like <code>[8,8,8]</code> </p><p>returns regular MP Gamma-centered k-point grid and (equal) k-weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3181-L3187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.trim" href="#ThreeBodyTB.TB.trim"><code>ThreeBodyTB.TB.trim</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function trim(h::tb, tol=0.0002)</code></pre><p>Remove terms in <code>tb</code> with abs value smaller than <code>tol</code>. (Ryd) Will speed calculations at cost of accuracy. USE WITH CARE. Usually not necessary except for very large or very detailed calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3235-L3241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.organizedata" href="#ThreeBodyTB.TB.organizedata"><code>ThreeBodyTB.TB.organizedata</code></a> — <span class="docstring-category">Function</span></header><section><div><p>function organizedata(tbc::tb_crys)</p><p>Rearrange the data in the tbc as a function of distances for plotting purposes.</p><p><code>return data_onsite, data_arr</code></p><p>Returns two arrays. The first has data on the onsite elements.</p><ul><li>column 1 and 3 have atom indexes</li><li>column 2 and 4 have orbital numbers</li><li>columns 5 and 6 have real and imaginary parts of H</li><li>columns 11 and 12 have real and imaginary parts of S</li><li>column 7 has the closest inter-atomic distance</li><li>column 8 has the index of the closest atom.</li></ul><p>The second has intersite data</p><ul><li>column 1 and 3 have atom indexes for the atom pairs</li><li>column 2 and 4 have orbital numbers</li><li>columns 5 and 6 have real and imaginary parts of H</li><li>columns 11 and 12 have real and imaginary parts of S</li><li>column 7 has the inter-atomic distance</li><li>column 8,9,10 have the the direction cosines lmn for the atom pair.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3330-L3355">source</a></section><section><div><pre><code class="language-julia hljs">function organizedata(crys::crystal, h::tb)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3382-L3384">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.myfft_R_to_K" href="#ThreeBodyTB.TB.myfft_R_to_K"><code>ThreeBodyTB.TB.myfft_R_to_K</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function myfft_R_to_K(tbc, grid=missing)</code></pre><p>Does Fourier Transform R-&gt;k (fft) using FFTW for tb_crys</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3500-L3504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.myfft" href="#ThreeBodyTB.TB.myfft"><code>ThreeBodyTB.TB.myfft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function myfft(crys, nonorth, grid, kpts,ham_kS, Sk=missing)</code></pre><p>Does Fourier Transform K-&gt;R (ifft) using FFTW.</p><p>Arguments</p><ul><li><code>crys</code> crystal</li><li><code>nonorth</code> nonorogonal bool</li><li><code>grid</code> k-point grid size</li><li><code>kpts</code> the k-points <code>nkpts</code>×<code>3</code> in the original order, to be rearranged into grid</li><li><code>ham_kS</code> hamiltonian in k space (<code>nw</code>×<code>nw</code>×<code>nkpts</code>)</li><li><code>Sk</code> overlaps in k space</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3559-L3572">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.get_sym_R" href="#ThreeBodyTB.TB.get_sym_R"><code>ThreeBodyTB.TB.get_sym_R</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function get_sym_R(crys, grid, sss = 1.0)</code></pre><p>Figures out the r-space grid using Wigner-Seitz like construction to figure out the best arrangement of r-grid points to keep periodic copies closest to the original atom  and take into account symmetry.</p><p><code>return R_grid, R_int_grid, sym_R</code></p><p>returns the R_grid, the integer version, and the symmetry factor of each point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3705-L3716">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.tb_indexes" href="#ThreeBodyTB.TB.tb_indexes"><code>ThreeBodyTB.TB.tb_indexes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function tb_indexes(d::dftout)</code></pre><p>Figures out mapping between DFT projected hamiltonian orbitals and crystal and the wannier orbitals we want.</p><p><code>return wan, semicore, nwan, nsemi, wan_atom, atom_wan</code></p><ul><li><code>wan</code> has the indexes of the wannier orbitals</li><li><code>semicore</code> has the indexes of semicore states.</li><li><code>nwan</code> number of wannier orbs</li><li><code>nsemi</code> number of semicore states</li><li><code>wan_atom</code> dictionary wannier to atom numbers</li><li><code>atom_wan</code> dictionary atom numbers to wannier orbitals</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3859-L3872">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.find_vbm_cbm" href="#ThreeBodyTB.TB.find_vbm_cbm"><code>ThreeBodyTB.TB.find_vbm_cbm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function find_vbm_cbm(eigs, fermi)</code></pre><p>Find the valence band max and conduction band minimum from eigs, relative to Fermi level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3954-L3958">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.ewald_energy" href="#ThreeBodyTB.TB.ewald_energy"><code>ThreeBodyTB.TB.ewald_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function ewald_energy(tbc::tb_crys, delta_q=missing)</code></pre><p>Return ewald energy term from tbc. If <code>delta_q</code>, the atomic charge density, is missing, loads from <code>tbc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3976-L3981">source</a></section><section><div><pre><code class="language-julia hljs">function ewald_energy(tbc::tb_crys_kspace, delta_q=missing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L3996-L3998">source</a></section><section><div><pre><code class="language-julia hljs">function ewald_energy(crys::crystal, gamma, delta_q::Array{Float64,1})</code></pre><p>Does the actual calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4013-L4017">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.get_dq" href="#ThreeBodyTB.TB.get_dq"><code>ThreeBodyTB.TB.get_dq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function get_dq(tbc::tb_crys_kspace)</code></pre><p>Get atomic charge density from <code>tb_crys</code> or <code>tb_crys_kspace</code> or <code>crys + eden</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4149-L4153">source</a></section><section><div><pre><code class="language-julia hljs">function get_dq(tbc::tb_crys)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4159-L4161">source</a></section><section><div><pre><code class="language-julia hljs">function get_dq(crys::crystal, chargeden::Array{Float64,1})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4166-L4168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.TB.get_energy_electron_density_kspace" href="#ThreeBodyTB.TB.get_energy_electron_density_kspace"><code>ThreeBodyTB.TB.get_energy_electron_density_kspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function get_energy_electron_density_kspace(tbcK::tb_crys_kspace; smearing = 0.01)</code></pre><p>Get energy / charge density from k-space tight binding object.</p><p><code>return bandenergy + etypes + echarge + energy_smear, eden, VECTS, VALS, error_flag</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4299-L4306">source</a></section><section><div><pre><code class="language-julia hljs">function get_energy_electron_density_kspace(tb_k::tb_k, nelec; smearing = 0.01)</code></pre><p>K-space get energy and electron density from <code>tb_k</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/TB.jl#L4344-L4348">source</a></section></article><h2 id="AtomicProj"><a class="docs-heading-anchor" href="#AtomicProj">AtomicProj</a><a id="AtomicProj-1"></a><a class="docs-heading-anchor-permalink" href="#AtomicProj" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj" href="#ThreeBodyTB.AtomicProj"><code>ThreeBodyTB.AtomicProj</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module AtomicProj</code></pre><p>Analyze projections from QE projwfc.x</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.proj_dat" href="#ThreeBodyTB.AtomicProj.proj_dat"><code>ThreeBodyTB.AtomicProj.proj_dat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct proj_dat</code></pre><p>Holds data from projwfc.x</p><ul><li><code>bs::bandstructure</code></li><li><code>natwfc::Int64</code> number of atomic wavefunctions, from dft projection</li><li><code>proj::Array{Complex{Float64}, 3}</code>  atomc projections <code>nk × natwfc × nbnd</code> , where <code>nbnd</code> is the number of bands in DFT</li><li><code>overlaps::Array{Complex{Float64}, 3} overlap matrix from dft</code>nk × natwfc × natwfc`</li><li><code>nspin::Int64</code> number of psins</li></ul><p>This is created from <code>loadXML_proj</code>, which calls <code>make_proj</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.create_tb-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout}" href="#ThreeBodyTB.AtomicProj.create_tb-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout}"><code>ThreeBodyTB.AtomicProj.create_tb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function create_tb(p::proj_dat, d::dftout; energy_froz=missing, nfroz=0, shift_energy=true)</code></pre><p>Does the main creation of TB hamiltonian from DFT projection data in k-space.</p><p><strong>Arguments</strong></p><ul><li><code>p::proj_dat</code> Projection data</li><li><code>d::dftout</code> DFT scf data</li><li><code>energy_froz=missing</code> Energy to start freezing eigenvalues</li><li><code>nfroz=0</code> number of frozen bands.</li><li><code>shift_energy=true</code> if <code>true</code> shift eigenvalues so band energy <code>==</code> total energy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L923-L934">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.get_ham_r-Tuple{tb_crys_kspace}" href="#ThreeBodyTB.AtomicProj.get_ham_r-Tuple{tb_crys_kspace}"><code>ThreeBodyTB.AtomicProj.get_ham_r</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_ham_r(tbck::tb_crys_kspace)</code></pre><p>Do fft to get the real-space ham. Requires tbck to be on a regular grid centered at Gamma with no symmetry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L1690-L1694">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.get_ham_r_slow-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout, Any, Array{ComplexF64, 3}}" href="#ThreeBodyTB.AtomicProj.get_ham_r_slow-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout, Any, Array{ComplexF64, 3}}"><code>ThreeBodyTB.AtomicProj.get_ham_r_slow</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_ham_r_slow(p::proj_dat, d::dftout, grid, ham_k::Array{Complex{Float64}, 3}; nonorth=true, K=missing)</code></pre><p>Slow method for doing fourier transform. Uses standard ft formula, not fft.</p><p>Use fast version instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L1361-L1367">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.loadXML_proj" href="#ThreeBodyTB.AtomicProj.loadXML_proj"><code>ThreeBodyTB.AtomicProj.loadXML_proj</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function loadXML_proj(savedir, B=missing)</code></pre><p>Load proj from QE output file. Need the QE save dir like &quot;qe.save&quot;. <code>B</code> are reciprocal lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L656-L660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.makeOG-Tuple{Any, Any}" href="#ThreeBodyTB.AtomicProj.makeOG-Tuple{Any, Any}"><code>ThreeBodyTB.AtomicProj.makeOG</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function makeOG(prefix, tmpdir )</code></pre><p>open<em>grid.x inputfile. My workflow doesn&#39;t currently use this, as open</em>grid.x was unreliable, and I&#39;ve rewritten the code to avoid it and work directly with independent k-points only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L183-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.make_commands" href="#ThreeBodyTB.AtomicProj.make_commands"><code>ThreeBodyTB.AtomicProj.make_commands</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function make_commands(nprocs=1)</code></pre><p>Returns a dictionary with command lines to call external programs on the command line nprocs is the number of processors for parallel execution Needs to be changed for you specfic program locations  and mpi commands (if any)</p><p>This needs to be edited to actually run QE yourself. Running wannier90 is optional, not part of current code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Commands.jl#L8-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.make_proj-Tuple{Any, Any, Any}" href="#ThreeBodyTB.AtomicProj.make_proj-Tuple{Any, Any, Any}"><code>ThreeBodyTB.AtomicProj.make_proj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function make_proj(bs, proj, overlaps)</code></pre><p>Constructor for proj_dat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L814-L818">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.make_projwfcx-Tuple{Any, Any}" href="#ThreeBodyTB.AtomicProj.make_projwfcx-Tuple{Any, Any}"><code>ThreeBodyTB.AtomicProj.make_projwfcx</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function make_projwfcx(prefix, tmpdir)</code></pre><p>Create the inputfile for running projwfc.x from QE</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L124-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.makedict_proj-Tuple{Any}" href="#ThreeBodyTB.AtomicProj.makedict_proj-Tuple{Any}"><code>ThreeBodyTB.AtomicProj.makedict_proj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function makedict_proj(savedir)</code></pre><p>Return xml proj data from QE savedir</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.prepare_ham_k-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout, Any, Array{ComplexF64, 4}}" href="#ThreeBodyTB.AtomicProj.prepare_ham_k-Tuple{ThreeBodyTB.AtomicProj.proj_dat, dftout, Any, Array{ComplexF64, 4}}"><code>ThreeBodyTB.AtomicProj.prepare_ham_k</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function prepare_ham_k(p::proj_dat, d::dftout, grid, ham_k::Array{Complex{Float64}, 4}; nonorth=true, K=missing, localized_factor = 0.05, screening=1.0)</code></pre><p>Constructs the actual k-space hamiltonain, which involves lots of putting matricies in the correct form and de-orthogonalizing if desired.</p><p>#arguments</p><ul><li><code>p::proj_dat</code> projection data</li><li><code>d::dftout</code> dft data</li><li><code>grid</code> kpoint grid spacing </li><li><code>ham_k::Array{Complex{Float64}, 3}</code> Hamiltonian</li><li><code>nonorth=true</code> make a non-orthogonal TB </li><li><code>K=missing</code> k-point array, usually get from <code>p</code></li><li><code>localized_factor = 0.15</code> increase localization of overlaps.</li><li><code>screening=1.0</code> mulitply U by this factor. usually not used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L1534-L1548">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.projwfc_workf-Tuple{dftout}" href="#ThreeBodyTB.AtomicProj.projwfc_workf-Tuple{dftout}"><code>ThreeBodyTB.AtomicProj.projwfc_workf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function projwfc_workf(dft::dftout)</code></pre><p>This is the main workflow for the creation of TB matrix elements from QE DFT calculations.</p><p>Starting from a converged QE scf calculation...</p><ol><li><p>Run NSCF calculation with extra empty bands. If you want a real space TB object, these need to be a full k-point grid not using symmtery. k-space only can use irreducible k-points</p></li><li><p>Run projwfc.x</p></li><li><p>Construct the TB hamiltonian in k-space</p></li><li><p>(Optional) FT to real space</p></li><li><p>(Optional) cleanup wavefunctions.</p></li></ol><p><strong>Arguments</strong></p><ul><li><code>dft::dftout</code> The starting scf calculation</li><li><code>directory=&quot;./&quot;</code></li><li><code>nprocs=1</code> number of processors</li><li><code>freeze=true</code> Keep occupied eigenvalues fixed to exact DFT values</li><li><code>writefile=&quot;projham.xml&quot;</code> output file for real-space TB</li><li><code>writefilek=&quot;projham_K.xml&quot;</code> output file for k-space TB</li><li><code>skip_og=true</code>  Not used anymore</li><li><code>skip_proj=true</code> If projections are already run, don&#39;t run them again, load from file.</li><li><code>shift_energy=true</code> Shift energy of eigenvalues s.t. total energy equal band energy.</li><li><code>cleanup=true</code> Remove the large wavefunction files from disk, keeping nscf/projection files.</li><li><code>skip_nscf=true</code> If nscf calculation is already done, load results from file.</li><li><code>localized_factor = 0.15</code> Adjust extent of overlap matrix. 0.0 uses full atomic wavefunctions, which can be overly delocalized. 1.0 is fully localized.</li><li><code>only_kspace=false</code> Do not create real-space tb. Usually true in current code, as I can fit directly from k-space tb only.</li><li><code>screening = 1.0</code> If use a screening factor to reduce value of U in Ewald calculation. Usually leave at 1.0.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L337-L370">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.run_og" href="#ThreeBodyTB.AtomicProj.run_og"><code>ThreeBodyTB.AtomicProj.run_og</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function run_og(filename=&quot;og.in&quot;;  directory=&quot;./&quot;, nprocs=1)</code></pre><p>runs open_grid.x</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L204-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicProj.run_projwfcx" href="#ThreeBodyTB.AtomicProj.run_projwfcx"><code>ThreeBodyTB.AtomicProj.run_projwfcx</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function run_projwfcx(projfile=&quot;proj.in&quot;; directory=&quot;./&quot;, nprocs=1)</code></pre><p>Run projwfc.x from QE code</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/AtomicProj.jl#L148-L152">source</a></section></article><h2 id="BandStruct"><a class="docs-heading-anchor" href="#BandStruct">BandStruct</a><a id="BandStruct-1"></a><a class="docs-heading-anchor-permalink" href="#BandStruct" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.band_summary" href="#ThreeBodyTB.BandStruct.band_summary"><code>ThreeBodyTB.BandStruct.band_summary</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function band_summary(tbc, kgrid, fermi=missing)</code></pre><p>Produces summary of band structure. See below functions for more specific versions of function that automatically generate the k-points.</p><p>Note: gaps are not well-defined for non-magnetic systems with odd numbers of electrons, as they are required to be metals.</p><p>Returns <code>direct_gap, indirect_gap, gaptype, bandwidth</code></p><p>-<code>direct_gap</code>: minimum gap at one k-point between nominally filled and empty bands. Can be non-zero in metals.   -<code>indirect_gap</code>: LUMO - HOMO. Can be negative if material has a direct gap everywhere, but the conduction band at some k-point is below the valence band at a different k-point. Physically these are indirect gap semimetals.   -<code>gaptype</code> : is <code>:metal</code> for all metals, <code>:direct</code> or <code>:indirect</code> for insulators. -<code>bandwidth</code> : HOMO - minimum<em>band</em>energy. Included semicore states if they are in the TB calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L960-L976">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.band_summary-Tuple{tb_crys_kspace}" href="#ThreeBodyTB.BandStruct.band_summary-Tuple{tb_crys_kspace}"><code>ThreeBodyTB.BandStruct.band_summary</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function band_summary(tbc::tb_crys_kspace)</code></pre><p>Will use internal k-points by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L1088-L1092">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.band_summary-Tuple{tb_crys}" href="#ThreeBodyTB.BandStruct.band_summary-Tuple{tb_crys}"><code>ThreeBodyTB.BandStruct.band_summary</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function band_summary(tbc::tb_crys; kgrid=missing, kpts=missing)</code></pre><p>Will automatically generate standard k-grid by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L1071-L1075">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.get_kpath" href="#ThreeBodyTB.BandStruct.get_kpath"><code>ThreeBodyTB.BandStruct.get_kpath</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function get_kpath(kpath=[0.5 0 0 ; 0 0 0; 0.5 0.5 0.5], names = missing, npts=30)</code></pre><p>Construct a k_path for a band structure calculations. Very simple.</p><ul><li><code>kpath</code> high symmetry k-points in fractional BZ coordinates.</li><li><code>names</code> names of kpoints like <code>[&quot;Γ&quot;, &quot;X&quot;]</code></li><li><code>npts</code> number of points between high-symmetry kpoints</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L415-L423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr-Tuple{Any}" href="#ThreeBodyTB.BandStruct.plot_bandstr-Tuple{Any}"><code>ThreeBodyTB.BandStruct.plot_bandstr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr(h::tb)</code></pre><p>Plots using <code>tb</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L469-L473">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr-Tuple{tb_crys}" href="#ThreeBodyTB.BandStruct.plot_bandstr-Tuple{tb_crys}"><code>ThreeBodyTB.BandStruct.plot_bandstr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr(h::tb_crys; kpath, names = missing, proj_types=missing, proj_orbs = missing, proj_nums=missing)</code></pre><p>Plot the band structure of a <code>tb_crys</code> object. Can also perform a projected band structure if you specify at least one of <code>proj_types</code>, <code>proj_orbs</code>, <code>proj_nums</code>.</p><p>k-path specified by a kpath array and names.</p><p>Must do scf calculation before plotting.</p><p><strong>Arguments</strong></p><ul><li><code>h::tb_crys</code> - The tight-biding object we want to plot bands from. Only required argument.</li><li><code>kpath=[0.5 0 0 ; 0 0 0; 0.5 0.5 0.5; 0 0.5 0.5; 0 0 0 ;0 0 0.5]</code> - <code>nk</code> × 3 array k-point path (high symmetry points).</li><li><code>npts=30,</code> - number of points between high-symmetry k-points.</li><li><code>names=missing</code> - <code>nk</code> string array. Names of the high-symmetry k-points </li><li><code>proj_types=missing</code> - types to project onto. Either <code>proj_types=&quot;H&quot;</code> or <code>proj_types=[&quot;H&quot;, &quot;O&quot;]</code> are valid.</li><li><code>proj_orbs=missing</code> - orbitals to project onto. either <code>proj_orbs=:s</code> or <code>proj_orbs=[:s, :p]</code>.</li><li><code>proj_nums=missing</code> - atom numbers to project onto. Either <code>proj_nums=1</code> or <code>proj_nums=[1, 2]</code></li><li><code>efermi=missing</code> - allows you to specify fermi energy. Default is to take from <code>h</code></li><li><code>color=&quot;blue&quot;</code> - specify line color</li><li><code>MarkerSize=missing&quot;</code> - specify markersize</li><li><code>yrange=missing&quot;</code> - specify y-range. e.g. <code>yrange=[-0.7, 0.3]</code></li><li><code>plot_hk=false</code> - plot things besides the normal band structure. Can be one of <code>:Seig, :Heig, :Hreal, :Himag, :Sreal, :Simag</code> to plot H or S eigvals or components. Primarily for debugging.</li><li><code>align=&quot;vbm&quot;</code> - default or <code>&quot;valence&quot;</code> is to align valence band max to zero energy. Can also be <code>&quot;min&quot;</code>, which aligns on the minimum eigenvalue, or <code>&quot;fermi&quot;</code> or <code>&quot;ef&quot;</code>, which align on the Fermi level, </li><li><code>clear_pervious=true</code> - clears the plot before adding new stuff.</li><li><code>do_display=true</code> - display the plot. If <code>false</code>, can be used with display-less nodes. You can still use <code>savefig</code> from <code>Plots</code> to produce saved images.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L113-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr_dos-Tuple{crystal}" href="#ThreeBodyTB.BandStruct.plot_bandstr_dos-Tuple{crystal}"><code>ThreeBodyTB.BandStruct.plot_bandstr_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr_dos(c::crystal; sym_prec = 5e-4, npts=30, efermi = missing,color=&quot;blue&quot;, MarkerSize=missing,yrange=missing,plot_hk=false, align = &quot;fermi&quot;,  proj_types = missing, proj_orbs = missing, proj_nums=missing, clear_previous=true, do_display=true, color_spin = [&quot;green&quot;, &quot;orange&quot;],  spin = :both, nspin = 1, database=missing, smearing = 0.025)</code></pre><p>Run SCF in standardized crystal structure and calculate band structure along symmetry-derived k-lines, as well as the DOS. Then plot them layed out side-by-side.</p><p>See <code>plot_bandstr_sym</code> and <code>dos</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L267-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr_dos-Tuple{tb_crys}" href="#ThreeBodyTB.BandStruct.plot_bandstr_dos-Tuple{tb_crys}"><code>ThreeBodyTB.BandStruct.plot_bandstr_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr_dos(tbc::tb_crys)</code></pre><p>Plot symmetry-derived k-lines and DOS layout out together. This version takes in <code>tb_crys</code> object from a previous SCF calculation. Will need re-run SCF if <code>tbc.crys</code> is not standardized.</p><p>See <code>plot_bandstr_sym</code> and <code>dos</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L315-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr_sym-Tuple{crystal}" href="#ThreeBodyTB.BandStruct.plot_bandstr_sym-Tuple{crystal}"><code>ThreeBodyTB.BandStruct.plot_bandstr_sym</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr_sym(c::crystal; sym_prec = 5e-4, npts=30, efermi = missing, color=&quot;blue&quot;, MarkerSize=missing, yrange=missing, plot_hk=false, align = &quot;vbm&quot;, proj_types = missing, proj_orbs = missing, proj_nums=missing, clear_previous=true, do_display=true, color_spin = [&quot;green&quot;, &quot;orange&quot;], spin = :both, nspin = 1, database=missing)</code></pre><p>Plots the band structure using a set of K-points determined by the space group. Will standardize the crystal structure and run the SCF  calculation automatically. Conventions similar to Setyawan and Curtarolo CMS 2010 as well as the jarvis-tools package. Other options similar to <code>plot_bandstr</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L174-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_bandstr_sym-Tuple{tb_crys}" href="#ThreeBodyTB.BandStruct.plot_bandstr_sym-Tuple{tb_crys}"><code>ThreeBodyTB.BandStruct.plot_bandstr_sym</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_bandstr_sym(tbc::tb_crys;  sym_prec = 5e-4, npts=30, efermi = missing, color=&quot;blue&quot;, MarkerSize=missing, yrange=missing, plot_hk=false, align = &quot;vbm&quot;, proj_types = missing, proj_orbs = missing, proj_nums=missing, clear_previous=true, do_display=true, color_spin = [&quot;green&quot;, &quot;orange&quot;], spin = :both, nspin = 1, database=missing)</code></pre><p>Plots the band structure using a set of K-points determined by the space group. This version takes in a tight-binding crystal object from a pervious SCF calculation.  If the crystal is in the standardized unit cell, then it will not repeat the SCF calculation, but otherwise it will.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L218-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_dft-Tuple{Any, Any}" href="#ThreeBodyTB.BandStruct.plot_compare_dft-Tuple{Any, Any}"><code>ThreeBodyTB.BandStruct.plot_compare_dft</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_compare_dft(tbc, bs; tbc2=missing)</code></pre><p>Plots a band structure comparison between a tight-binding crystal object (<code>tb_crys</code>) and a band structure directly from dft (either a <code>dftout</code> or <code>bs</code> object). </p><p>The k-points are fixed by the <code>bs</code> object.</p><p><code>tbc2</code> is an optional second <code>tbc_crys</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L768-L777">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{tb, tb}" href="#ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{tb, tb}"><code>ThreeBodyTB.BandStruct.plot_compare_tb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_compare_tb(h1::tb, h2::tb; h3=missing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L86-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{tb_crys, tb_crys}" href="#ThreeBodyTB.BandStruct.plot_compare_tb-Tuple{tb_crys, tb_crys}"><code>ThreeBodyTB.BandStruct.plot_compare_tb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_compare_tb(h1::tb_crys, h2::tb_crys; h3=missing)</code></pre><p>Plot a comparison between different tight binding objects <code>h1</code>, <code>h2</code>, and optionally <code>h3</code>. Options similar to <code>plot_bandstr</code> but more limited.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L67-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.run_dft_compare-Tuple{Any}" href="#ThreeBodyTB.BandStruct.run_dft_compare-Tuple{Any}"><code>ThreeBodyTB.BandStruct.run_dft_compare</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function run_dft_compare(tbc; nprocs=1, prefix=&quot;qe&quot;,   outdir=&quot;./&quot;, kpath=[0.5 0 0 ; 0 0 0; 0.5 0.0 0.5], names = missing, npts=30, efermi = missing, yrange=missing,   align=&quot;vbm&quot;)</code></pre><p>This function will run a new QE dft calculation and band structure calculation and compare the bands with the tight binding model tbc.</p><p><code>outdir</code> is the location the QE files will be stored.</p><p>Other options like the other plotting commands</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L914-L922">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandStruct.setup_proj-NTuple{5, Any}" href="#ThreeBodyTB.BandStruct.setup_proj-NTuple{5, Any}"><code>ThreeBodyTB.BandStruct.setup_proj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function setup_proj(crys, nwan, proj_types, proj_orbs, proj_nums)</code></pre><p>Figure out projection indexes</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandStruct.jl#L366-L370">source</a></section></article><h2 id="DOS"><a class="docs-heading-anchor" href="#DOS">DOS</a><a id="DOS-1"></a><a class="docs-heading-anchor-permalink" href="#DOS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.dos-Tuple{tb_crys}" href="#ThreeBodyTB.DOS.dos-Tuple{tb_crys}"><code>ThreeBodyTB.DOS.dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function dos(tbc::tb_crys; grid=missing, smearing=0.04, npts=missing, proj_type=missing, do_display=true)</code></pre><p>DOS, mostly for testing.</p><ul><li><code>npts</code> is number of energies</li><li><code>proj_type</code> can be <code>&quot;none&quot;</code>, <code>&quot;atomic&quot;</code>, or <code>&quot;orbital&quot;</code></li><li><code>do_display=false</code> will suppress the actual plot</li></ul><p>The combination of <code>smearing</code> and <code>grid</code> are important to get converged results.</p><p>See also <code>dos</code></p><p><code>return energies, dos, projected_dos, pdos_names</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L400-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.dos_realspace-Tuple{Any}" href="#ThreeBodyTB.DOS.dos_realspace-Tuple{Any}"><code>ThreeBodyTB.DOS.dos_realspace</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function dos_realspace(tbc; direction=3, grid=missing, smearing=0.005, npts=missing, do_display=true, use_sym=false, energy_grid=100, width=missing, energy_lims=missing, scissors_shift=0.0, scissors_shift_atoms=[])</code></pre><p>Makes an atom and spatially resoloved DOS-style plot. Along <code>direction=1,2,3</code> (lattice vector 1,2,3) the atoms are plotted, using transparancy to denote DOS amplitude. Try it out to see. Potentially useful for interfaces. Example usage: <code>c = makecrys([8.0 0 0; 0 8.0 0; 0 0 10.0], [0 0 0; 0 0 0.5], [:Li, :Cl]) #quasi 1D LiCl chain</code> <code>en, tbc, flag = scf_energy(c*[1,1,10])                                   #ten unit cells</code> <code>dos_realspace(tbc, direction=3)</code></p><p>Adjust the <code>energy_grid</code> and <code>width</code> to adjust plotting parameters. Scissors shift in energy unit to certain atoms will add scissors shift to open band gaps is desired.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L254-L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.dos_tetra-Tuple{tb_crys}" href="#ThreeBodyTB.DOS.dos_tetra-Tuple{tb_crys}"><code>ThreeBodyTB.DOS.dos_tetra</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function dos_tetra(tbc::tb_crys; grid=missing, npts=missing, proj_type=missing, do_display=true)</code></pre><p>DOS, using tetrahedral integration</p><ul><li><code>grid</code> is the k-point grid. Defaults to 1.6 times the default grid for energy integration.</li><li><code>npts</code> is number of energies</li><li><code>proj_type</code> can be <code>&quot;none&quot;</code>, <code>&quot;atomic&quot;</code>, or <code>&quot;orbital&quot;</code>. Defaults to <code>atomic</code> if more than one atom type.</li><li><code>do_display=false</code> will suppress plotting</li></ul><p><code>return energies, dos, projected_dos, pdos_names</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L744-L755">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.gaussian_dos-Tuple{tb_crys}" href="#ThreeBodyTB.DOS.gaussian_dos-Tuple{tb_crys}"><code>ThreeBodyTB.DOS.gaussian_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function gaussian_dos(tbc::tb_crys)</code></pre><p>Gaussian smearing DOS is now the main DOS. Tetraheral method is still coded, but it is a bit wonky.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L389-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.plot_dos-NTuple{4, Any}" href="#ThreeBodyTB.DOS.plot_dos-NTuple{4, Any}"><code>ThreeBodyTB.DOS.plot_dos</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_dos(energies, dos, pdos, names; filename=missing, do_display=true)</code></pre><p>Does the actual DOS plotting, called by <code>dos</code> or <code>gaussian_dos</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L1057-L1061">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.plot_dos_flip-NTuple{4, Any}" href="#ThreeBodyTB.DOS.plot_dos_flip-NTuple{4, Any}"><code>ThreeBodyTB.DOS.plot_dos_flip</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function plot_dos_flip(energies, dos, pdos, names; filename=missing, do_display=true, yrange=[-6, 4.0])</code></pre><p>For plotting with x and y axes reversed, useful for bandstucture plots</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L1147-L1151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.projection-Tuple{tb_crys, Any, Any, Any}" href="#ThreeBodyTB.DOS.projection-Tuple{tb_crys, Any, Any, Any}"><code>ThreeBodyTB.DOS.projection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function projection(tbc::tb_crys, vects, sk3, grid; ptype=missing)</code></pre><p>Figures out the projections. <code>ptype</code> can be <code>:atomic</code> or <code>:orbs</code> for atom projection or orbital projection (:s,:p,:d) Default is to choose <code>:atomic</code> except for elemental systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L105-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DOS.setup_tetra-Tuple{Any}" href="#ThreeBodyTB.DOS.setup_tetra-Tuple{Any}"><code>ThreeBodyTB.DOS.setup_tetra</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function setup_tetra(grid)</code></pre><p>Setup simple tetrahedron method based on tetra.f90 in QE. Simple tetra method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DOS.jl#L650-L656">source</a></section></article><h2 id="Atomdata"><a class="docs-heading-anchor" href="#Atomdata">Atomdata</a><a id="Atomdata-1"></a><a class="docs-heading-anchor-permalink" href="#Atomdata" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata" href="#ThreeBodyTB.Atomdata"><code>ThreeBodyTB.Atomdata</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module Atomdata</code></pre><p>Holds the data for isolated atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atom_prefered_oxidation" href="#ThreeBodyTB.Atomdata.atom_prefered_oxidation"><code>ThreeBodyTB.Atomdata.atom_prefered_oxidation</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">atom_prefered_oxidation::Dict()</code></pre><p>Prefered oxidation states of atoms, in descending order of preference (approximate).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L267-L271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atom_radius" href="#ThreeBodyTB.Atomdata.atom_radius"><code>ThreeBodyTB.Atomdata.atom_radius</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">atom_radius::Dict()</code></pre><p>Atomic radius (metallic), in pm</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L162-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.atoms" href="#ThreeBodyTB.Atomdata.atoms"><code>ThreeBodyTB.Atomdata.atoms</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">atoms::Dict()</code></pre><p>Periodic table information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.cutoff_dist" href="#ThreeBodyTB.Atomdata.cutoff_dist"><code>ThreeBodyTB.Atomdata.cutoff_dist</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">cutoff_dist::Dict()</code></pre><p>Cutoff distance for Hamiltonian calculation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L366-L370">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.electronegativity" href="#ThreeBodyTB.Atomdata.electronegativity"><code>ThreeBodyTB.Atomdata.electronegativity</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">electronegativity::Dict()</code></pre><p>Pauling scale.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L565-L569">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.min_dimer_dist_dict" href="#ThreeBodyTB.Atomdata.min_dimer_dist_dict"><code>ThreeBodyTB.Atomdata.min_dimer_dist_dict</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">min_dimer_dist_dict::Dict()</code></pre><p>Approximate minimum distance in current fitting data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L452-L456">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Atomdata.sub_list" href="#ThreeBodyTB.Atomdata.sub_list"><code>ThreeBodyTB.Atomdata.sub_list</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">sub_list::Dict()</code></pre><p>Most likely substitution list, approximate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomdata.jl#L471-L475">source</a></section></article><h2 id="AtomicMod"><a class="docs-heading-anchor" href="#AtomicMod">AtomicMod</a><a id="AtomicMod-1"></a><a class="docs-heading-anchor-permalink" href="#AtomicMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicMod" href="#ThreeBodyTB.AtomicMod"><code>ThreeBodyTB.AtomicMod</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module AtomicMod</code></pre><p>Simple module for atom type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomic.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicMod.atom" href="#ThreeBodyTB.AtomicMod.atom"><code>ThreeBodyTB.AtomicMod.atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct atom</code></pre><p>Hold basic atomic information</p><ul><li><code>name::String</code> </li><li><code>Z::Int64</code> Atomic number</li><li><code>row::Float64</code> Periodic table row</li><li><code>col::Float64</code> Periodic table col</li><li><code>mass::Float64</code> Mass in amu </li><li><code>nval::Float64</code> Number of valence electrons in TB calculation.</li><li><code>nsemicore::Int64</code> Number of semicore electrons. Depends on pseudopotential choice</li><li><code>nwan::Int64</code> Number of TB orbitals</li><li><code>orbitals::Array{Symbol,1}</code> Names of the orbitals, like <code>[:s, :p]</code></li><li><code>total_energy::Float64</code> DFT total energy, depends on pseudopotentials.</li><li><code>eigs::Dict</code> orbital eigenvalues of isolated non-spin-polarized nuetral atom.</li><li><code>energy_offset::Float64</code> energy to add to TB calculation to make isolated atoms have zero energy.</li><li><code>U::Float64</code> U value for Ewald correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomic.jl#L122-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.AtomicMod.makeatom" href="#ThreeBodyTB.AtomicMod.makeatom"><code>ThreeBodyTB.AtomicMod.makeatom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function makeatom(name, Z, row, col, mass, nval, nsemicore, orbitals, etot, eigs, vac_potential=0.0, U=0.0)</code></pre><p>Constructor for atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Atomic.jl#L176-L180">source</a></section></article><h2 id="BandTools"><a class="docs-heading-anchor" href="#BandTools">BandTools</a><a id="BandTools-1"></a><a class="docs-heading-anchor-permalink" href="#BandTools" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandTools" href="#ThreeBodyTB.BandTools"><code>ThreeBodyTB.BandTools</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module BandTools</code></pre><p>Utility functions for manipulating band structures. These need to be defined early in the code so other Modules have acccess to them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandTools.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandTools.band_energy" href="#ThreeBodyTB.BandTools.band_energy"><code>ThreeBodyTB.BandTools.band_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function band_energy(eigs, weights, nelec, smearing = 0.01; returnk=false, returnocc=false, returnef=false, returnboth=false)</code></pre><p>Calculate band energy. Has options for additional return variables. Calculates fermi energy internally.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandTools.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandTools.calc_fermi" href="#ThreeBodyTB.BandTools.calc_fermi"><code>ThreeBodyTB.BandTools.calc_fermi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_fermi(eigs, weights, nelec, smearing = 0.01)</code></pre><p>calculate fermi energy using bisection</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandTools.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.BandTools.smearing_energy" href="#ThreeBodyTB.BandTools.smearing_energy"><code>ThreeBodyTB.BandTools.smearing_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function smearing_energy(eigs, weights, efermi, smearing = 0.01)</code></pre><p>Smearing contribution to total energy. If you don&#39;t take this int account in metals or  small gap semiconductors, your energy is not variational  in the correct way, and things like forces and stresses become wrong.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/BandTools.jl#L146-L152">source</a></section></article><h2 id="CalcTB"><a class="docs-heading-anchor" href="#CalcTB">CalcTB</a><a id="CalcTB-1"></a><a class="docs-heading-anchor-permalink" href="#CalcTB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB" href="#ThreeBodyTB.CalcTB"><code>ThreeBodyTB.CalcTB</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module CalcTB</code></pre><p>Create TB matrix sets from coefficients, or prepare to fit the coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.coefs" href="#ThreeBodyTB.CalcTB.coefs"><code>ThreeBodyTB.CalcTB.coefs</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct coefs</code></pre><p>Hold the TB coefficients for 2body or 3body interactions</p><ul><li><code>dim::Int64</code> - dimension (2 or 3)</li><li><code>datH::Array{Float64,1}</code> Hamiltonian parameters</li><li><code>datS::Array{Float64,1}</code>  Overlap parameters, if any</li><li><code>sizeH::Int64</code> </li><li><code>sizeS::Int64</code></li><li><code>inds::Dict{Array{Symbol}, Array{Int64,1}}</code> Holds inds that tell which coeffiecients correspond to which atoms/orbitals</li><li><code>inds_int::Dict{Array{Symbol}, Any}</code> Holds inds that tell which coeffiecients correspond to which atoms/orbitals, but integer array</li><li><code>ninds_int::Dict{Array{Symbol}, Array{UInt16,2}}</code> Holds number of coefs</li><li><code>names::Set</code> Names of atoms</li><li><code>orbs::Array{Any,1}</code> Orbitals </li><li><code>cutoff::Float64</code> cutoff distance</li><li><code>min_dist::Float64</code> minimum atom-atom distance in fitting data</li><li><code>maxmin_val_train::Dict</code> max and min value of matrix elements within fitting data</li><li><code>dist_frontier::Dict</code> dictionary of pareto frontier of shortest fitting distances</li><li><code>version::Int64</code> version number</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L117-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_frontier-Tuple{crystal, Any}" href="#ThreeBodyTB.CalcTB.calc_frontier-Tuple{crystal, Any}"><code>ThreeBodyTB.CalcTB.calc_frontier</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_frontier(crys::crystal, frontier; var_type=Float64, test_frontier=false, diststuff=missing, verbose=true)</code></pre><p>Calculate a pareto frontier of short distances. For 2body interactions, this is just a single distance, which is easy. For 3body interactions, there are 3 distances, so multiple points are on the frontier. Useful for deciding if old fitting data applies to a new structure with atoms that are close together.</p><p><code>test_frontier=true</code> is used to check if new structure is in the frontier. othersise, see if new structure changes frontier.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L2845-L2855">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_onsite" href="#ThreeBodyTB.CalcTB.calc_onsite"><code>ThreeBodyTB.CalcTB.calc_onsite</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_onsite(t1,s1,s2, database=missing)</code></pre><p>Handles atomic matrix els. We do not currently fit onsite matrix els</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4446-L4450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_tb_LV_sparse" href="#ThreeBodyTB.CalcTB.calc_tb_LV_sparse"><code>ThreeBodyTB.CalcTB.calc_tb_LV_sparse</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function calc_tb_LV_sparse(crys::crystal)</code></pre><p>Main sparse matrix tight binding Hamiltonian calculator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre_sparse.jl#L208-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_tb_fast" href="#ThreeBodyTB.CalcTB.calc_tb_fast"><code>ThreeBodyTB.CalcTB.calc_tb_fast</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_tb_fast(crys::crystal; database=missing, use_threebody=true, use_threebody_onsite=true)</code></pre><p>Construct <code>tb_crys</code> from crystal stucture, but does not solve. This is usually called internally by functions like <code>scf_energy</code>, but you can use it directly if you want. Until you do a SCF energy calculation, the electron density and Fermi level will be wrong.</p><p><strong>Arguments</strong></p><ul><li><code>crys::crystal</code> - Required crystal structure</li><li><code>database=missing</code> - Source of coefficients. Will load from default source if not specified.</li><li><code>use_threebody=true</code> - Use three-body off-site interactions. Only turn off for testing purposes.</li><li><code>use_threebody_onsite=true</code> - Use three-body on-site interactions. Only turn off for testing purposes.</li><li><code>verbose=true</code> - set to false for less output.</li><li><code>var_type=missing</code> - variable type of <code>tb_crys</code>. Default is <code>Float64</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L1818-L1833">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_tb_prepare_fast-Tuple{tb_crys}" href="#ThreeBodyTB.CalcTB.calc_tb_prepare_fast-Tuple{tb_crys}"><code>ThreeBodyTB.CalcTB.calc_tb_prepare_fast</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_tb_prepare_fast(reference_tbc::tb_crys; use_threebody=false, use_threebody_onsite=false)</code></pre><p>Take a <code>tbc</code> from DFT and rearrange it for use in fitting code. Basically set it up so that it is ready for a least squares linear fit of coefficients.</p><p><code>return twobody_arrays, threebody_arrays, hvec, svec, Rvec, INDvec, h_onsite, ind_conversion, dmin_types, dmin_types3</code></p><p>Where</p><ul><li><code>twobody_arrays</code> - info for fitting twobody coefficients</li><li><code>threebody_array</code> - info for fitting twobody coefficients</li><li><code>hvec</code> - vector of reference TB matrix els, arranged for fitting</li><li><code>svec</code> - vector of reference overlap matrix els, arranged for fitting</li><li><code>Rvec</code> - displaments</li><li><code>INDvec</code> info on which matrix el goes with which row</li><li><code>h_onsite</code> info for subtracting atomic terms, I think</li><li><code>ind_conversion</code> - dict to convert between place in hamiltonian and overall counter, which removes duplicates.</li><li><code>dmin_types</code> - shortest 2body distances</li><li><code>dmin_types</code> - shortest 3body distances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L3467-L3486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_threebody-NTuple{13, Any}" href="#ThreeBodyTB.CalcTB.calc_threebody-NTuple{13, Any}"><code>ThreeBodyTB.CalcTB.calc_threebody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_threebody(c,ind, t1,t2,t3,orb1,orb2,dist,dist31,dist32,lmn12, lmn31,lmn32; database=missing, memory0=missing, memory1=missing, memory2=missing, memoryV=missing, precalc=false, set_maxmin=false)</code></pre><p>Calculate 3body intersite hamiltonian interactions.</p><p><code>memory1</code>, etc have preallocated memory. This function is important for performance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L6088-L6094">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_threebody_onsite-NTuple{8, Any}" href="#ThreeBodyTB.CalcTB.calc_threebody_onsite-NTuple{8, Any}"><code>ThreeBodyTB.CalcTB.calc_threebody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_threebody_onsite(t1,t2,t3,orb1,dist12,dist13,dist23, database; set_maxmin=false, memory=missing)</code></pre><p>calculate threebody onsite interactions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L6009-L6013">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_twobody-NTuple{7, Any}" href="#ThreeBodyTB.CalcTB.calc_twobody-NTuple{7, Any}"><code>ThreeBodyTB.CalcTB.calc_twobody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_twobody(t1,t2,orb1,orb2,dist,lmn, database)</code></pre><p>Two body intersite Hamiltonian and overlap matrix els.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5720-L5724">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_twobody_faster-NTuple{12, Any}" href="#ThreeBodyTB.CalcTB.calc_twobody_faster-NTuple{12, Any}"><code>ThreeBodyTB.CalcTB.calc_twobody_faster</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_twobody(t1,t2,orb1,orb2,dist,lmn, database)</code></pre><p>Two body intersite Hamiltonian and overlap matrix els.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5782-L5786">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.calc_twobody_onsite-NTuple{7, Any}" href="#ThreeBodyTB.CalcTB.calc_twobody_onsite-NTuple{7, Any}"><code>ThreeBodyTB.CalcTB.calc_twobody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_twobody_onsite(t1,t2,orb1,orb2, dist,lmn, database)</code></pre><p>Calculate 2body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5930-L5934">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_threebody-NTuple{11, Any}" href="#ThreeBodyTB.CalcTB.fit_threebody-NTuple{11, Any}"><code>ThreeBodyTB.CalcTB.fit_threebody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function fit_threebody(t1,t2,t3,orb1,orb2,dist,dist31,dist32,lmn12, lmn31,lmn32)</code></pre><p>Fit threebody intersite interactions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L6123-L6127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_threebody_onsite-NTuple{7, Any}" href="#ThreeBodyTB.CalcTB.fit_threebody_onsite-NTuple{7, Any}"><code>ThreeBodyTB.CalcTB.fit_threebody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function fit_threebody_onsite(t1,t2,t3,orb1,dist12,dist13,dist23)</code></pre><p>Fit three body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L6063-L6067">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_twobody-NTuple{4, Any}" href="#ThreeBodyTB.CalcTB.fit_twobody-NTuple{4, Any}"><code>ThreeBodyTB.CalcTB.fit_twobody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function fit_twobody(orb1,orb2,dist,lmn)</code></pre><p>Fit Two body intersite Hamiltonian and overlap matrix els.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5865-L5869">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.fit_twobody_onsite-NTuple{6, Any}" href="#ThreeBodyTB.CalcTB.fit_twobody_onsite-NTuple{6, Any}"><code>ThreeBodyTB.CalcTB.fit_twobody_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function fit_twobody_onsite(t1,t2,orb1,orb2, dist,lmn)</code></pre><p>Fit 2body onsite interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5973-L5977">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.get_data_info_v1-Tuple{Any, Any}" href="#ThreeBodyTB.CalcTB.get_data_info_v1-Tuple{Any, Any}"><code>ThreeBodyTB.CalcTB.get_data_info_v1</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_data_info(at_set, dim)</code></pre><p>Figure out the arrangement of data in a <code>coefs</code> file.</p><p>Loops over various combinations of orbitals and atoms and assigns them places in <code>datH</code> and <code>datS</code>, depending on the terms included in the model and the dimensionaly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L1135-L1141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.get_data_info_v2-Tuple{Any, Any}" href="#ThreeBodyTB.CalcTB.get_data_info_v2-Tuple{Any, Any}"><code>ThreeBodyTB.CalcTB.get_data_info_v2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_data_info(at_set, dim)</code></pre><p>Figure out the arrangement of data in a <code>coefs</code> file.</p><p>Loops over various combinations of orbitals and atoms and assigns them places in <code>datH</code> and <code>datS</code>, depending on the terms included in the model and the dimensionaly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L761-L767">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.laguerre" href="#ThreeBodyTB.CalcTB.laguerre"><code>ThreeBodyTB.CalcTB.laguerre</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function laguerre(dist, ind=missing; nmax=6, memory=missing)</code></pre><p>Calculate laguerre polynomials up to order <code>nmax</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4577-L4581">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.make_coefs-Tuple{Any, Any}" href="#ThreeBodyTB.CalcTB.make_coefs-Tuple{Any, Any}"><code>ThreeBodyTB.CalcTB.make_coefs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function make_coefs(at_list, dim; datH=missing, datS=missing, cutoff=18.01, min_dist = 3.0, fillzeros=false, maxmin_val_train=missing, dist_frontier=missing)</code></pre><p>Constructor for <code>coefs</code>. Can create coefs filled with ones for testing purposes.</p><p>See <code>coefs</code> to understand arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L352-L358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.plot_database" href="#ThreeBodyTB.CalcTB.plot_database"><code>ThreeBodyTB.CalcTB.plot_database</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function plot_database(database, entry, t=missing)</code></pre><p>Plot some data from <code>coefs</code>. Needs to be updated to work with Plots, probably doesn&#39;t work now.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L572-L576">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.read_coefs" href="#ThreeBodyTB.CalcTB.read_coefs"><code>ThreeBodyTB.CalcTB.read_coefs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function read_coefs(filename, directory = missing)</code></pre><p>Read <code>coefs</code> from filename. Can read gzip directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L253-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.renormalize_S" href="#ThreeBodyTB.CalcTB.renormalize_S"><code>ThreeBodyTB.CalcTB.renormalize_S</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function renormalize_S(tbc, database, cutoff=17.99)</code></pre><p>Function for changing S but keeping the band structure fixed. Not currently used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L6150-L6154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.symmetry_factor_fit-Tuple{Any, Any, Any}" href="#ThreeBodyTB.CalcTB.symmetry_factor_fit-Tuple{Any, Any, Any}"><code>ThreeBodyTB.CalcTB.symmetry_factor_fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function symmetry_factor_fit(s1,s2,lmn)</code></pre><p>All the Slater-Koster factors, for fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5504-L5508">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.symmetry_factor_int-NTuple{4, Any}" href="#ThreeBodyTB.CalcTB.symmetry_factor_int-NTuple{4, Any}"><code>ThreeBodyTB.CalcTB.symmetry_factor_int</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function symmetry_factor(s1,s2,lmn, dat)</code></pre><p>All of the spd Slater-Koster matrix elements. <code>dat</code> is preallocated memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L5286-L5290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.three_body_H" href="#ThreeBodyTB.CalcTB.three_body_H"><code>ThreeBodyTB.CalcTB.three_body_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function two_body_H(dist, ind=missing)</code></pre><p>get 3body hamiltonian terms together.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4997-L5001">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.three_body_O" href="#ThreeBodyTB.CalcTB.three_body_O"><code>ThreeBodyTB.CalcTB.three_body_O</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function two_body_O(dist, ind=missing)</code></pre><p>three body onsite.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4685-L4689">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.trim_dist" href="#ThreeBodyTB.CalcTB.trim_dist"><code>ThreeBodyTB.CalcTB.trim_dist</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function trim_dist(tbc, cutoff=18.0001)</code></pre><p>Reduce the atom-atom hamiltonian terms longer than cutoff.</p><p>Not used in typical code, but can make <code>tbc</code> run faster / reduce memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L1739-L1745">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_H" href="#ThreeBodyTB.CalcTB.two_body_H"><code>ThreeBodyTB.CalcTB.two_body_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function two_body_H(dist, ind=missing)</code></pre><p>Two body intersite Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4971-L4975">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_O" href="#ThreeBodyTB.CalcTB.two_body_O"><code>ThreeBodyTB.CalcTB.two_body_O</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function two_body_O(dist, ind=missing)</code></pre><p>Two body onsite</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4672-L4676">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.two_body_S" href="#ThreeBodyTB.CalcTB.two_body_S"><code>ThreeBodyTB.CalcTB.two_body_S</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function two_body_H(dist, ind=missing)</code></pre><p>Two body intersite overlap.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L4984-L4988">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CalcTB.write_coefs-Tuple{Any, ThreeBodyTB.CalcTB.coefs}" href="#ThreeBodyTB.CalcTB.write_coefs-Tuple{Any, ThreeBodyTB.CalcTB.coefs}"><code>ThreeBodyTB.CalcTB.write_coefs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function write_coefs(filename, co::coefs; compress=true)</code></pre><p>Write <code>coefs</code> to a file. Compress uses gzip. See <code>read_coefs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/CalcTB_laguerre.jl#L190-L194">source</a></section></article><h2 id="CrystalMod"><a class="docs-heading-anchor" href="#CrystalMod">CrystalMod</a><a id="CrystalMod-1"></a><a class="docs-heading-anchor-permalink" href="#CrystalMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.parsePOSCAR" href="#ThreeBodyTB.CrystalMod.parsePOSCAR"><code>ThreeBodyTB.CrystalMod.parsePOSCAR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function parsePOSCAR(lines)</code></pre><p>Parse a POSCAR from VASP</p><p>Called by makecrys, doesn&#39;t need to be called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L585-L591">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.parseQEinput" href="#ThreeBodyTB.CrystalMod.parseQEinput"><code>ThreeBodyTB.CrystalMod.parseQEinput</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function parseQEinput(lines)</code></pre><p>Parse a quantum espresso inputfile. Can only handle simple cases with explict CELL_PARAMETERS Cannot handle nonzero ibrav. or celldm</p><p>Called by makecrys, doesn&#39;t need to be called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L657-L664">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.generate_supercell" href="#ThreeBodyTB.CrystalMod.generate_supercell"><code>ThreeBodyTB.CrystalMod.generate_supercell</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function generate_supercell(crys, cell)</code></pre><p>Generate supercell. cell is <code>[1,1,2]</code>, etc. </p><p>Note, perfered notation is to use syntax: <code>c * [1,1,2]</code> , where <code>c</code> is a crystal, thus  using overloading of the <code>*</code> operator,  rather than calling directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L743-L752">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.generate_random_distortion" href="#ThreeBodyTB.CrystalMod.generate_random_distortion"><code>ThreeBodyTB.CrystalMod.generate_random_distortion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function generate_random_distortion(crys, amag, strain_mag)</code></pre><p>Randomly distort a crystal. <code>amag</code> is the atom distance, <code>strain_mag</code> is the strain magnitude</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L1051-L1055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.generate_optimum_supercell" href="#ThreeBodyTB.CrystalMod.generate_optimum_supercell"><code>ThreeBodyTB.CrystalMod.generate_optimum_supercell</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function generate_optimum_supercell(c::crystal, dist)</code></pre><p>Generate a supercell of crystal <code>c</code> where the periodic copies of all atoms are at least <code>dist</code> apart. Will consider (some) linear combinations of the initial lattice vectors and look for the &quot;best&quot; cell.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L820-L826">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.write_poscar" href="#ThreeBodyTB.CrystalMod.write_poscar"><code>ThreeBodyTB.CrystalMod.write_poscar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function write_poscar(crys, filename)</code></pre><p>Write a <code>crystal</code> to a POSCAR.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L1071-L1075">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.write_efs" href="#ThreeBodyTB.CrystalMod.write_efs"><code>ThreeBodyTB.CrystalMod.write_efs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function function write_efs(crys, energy, forces, stress, filename)</code></pre><p>Write <code>crystal</code>, energy, force, stress to fake quantum espresso output file. This is for testing purposes only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L1216-L1221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.get_grid" href="#ThreeBodyTB.CrystalMod.get_grid"><code>ThreeBodyTB.CrystalMod.get_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function get_grid(c, kden=55.0)</code></pre><p>Get a default k-point grid size with <code>kden</code> density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L1268-L1272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.CrystalMod.orbital_index" href="#ThreeBodyTB.CrystalMod.orbital_index"><code>ThreeBodyTB.CrystalMod.orbital_index</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function orbital_index(c::crystal)</code></pre><p>Get correspondence between <code>crystal</code> and the TB orbital numbers.</p><p><code>return ind2orb, orb2ind, etotal, nval</code></p><ul><li><code>ind2orb</code> dictionary which gives <code>[atom_number,atom_type, :orbital_symbol]</code> from TB index integer.</li><li><code>orb2ind</code> dictionary which gives TB index integer from <code>[atom_number,atom_type, :orbital_symbol]</code></li><li><code>etotal</code> total DFT energy of atoms, for calculation atomization energy.</li><li><code>nval</code> number of valence orbitals.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Crystal.jl#L1327-L1338">source</a></section></article><h2 id="DFToutMod"><a class="docs-heading-anchor" href="#DFToutMod">DFToutMod</a><a id="DFToutMod-1"></a><a class="docs-heading-anchor-permalink" href="#DFToutMod" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod" href="#ThreeBodyTB.DFToutMod"><code>ThreeBodyTB.DFToutMod</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module DFToutMod</code></pre><p>Deal with energy, force, stress, band structure, etc, from a DFT calculation</p><p>Generic to different DFT codes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.bandstructure" href="#ThreeBodyTB.DFToutMod.bandstructure"><code>ThreeBodyTB.DFToutMod.bandstructure</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct bandstructure</code></pre><p>Band structure. Has</p><ul><li><code>nbnd::Int</code> Number of bands</li><li><code>nks::Int</code> Number of k-points</li><li><code>nelec::Float64</code> Number of electrons</li><li><code>nspin::Int64</code> Number of spins (2 for spin-polarized (magnetic), 1 non-sp)</li><li><code>efermi::Float64</code> Fermi energy</li><li><code>kpts::Array{Float64,2}</code> List of k-points, <code>nks × 3</code> array in BZ crystal units.</li><li><code>kweights::Array{Float64,1}</code> Weights of k-points (<code>nks</code>).</li><li><code>kgrid::Array{Int,1}</code> Equivalent gamma centered Monkhorst-Pack k-grid dimensions, if applies.</li><li><code>eigs::Array{Float64,3}</code> Eigenvalues. <code>nks × nbnd × nspin</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L44-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.dftout" href="#ThreeBodyTB.DFToutMod.dftout"><code>ThreeBodyTB.DFToutMod.dftout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct dftout</code></pre><p>DFT output struct. Has</p><ul><li><code>crys::crystal</code>  crystal structure</li><li><code>energy::Float64</code> the actual DFT energy, depends on pseudopotentials.</li><li><code>energy_smear::Float64</code> smearing energy</li><li><code>forces::Array{Float64,2}</code> forces Ryd / a.u.</li><li><code>stress::Array{Float64,2}</code> stress  Ryd / (a.u.)^3</li><li><code>bandstruct::bandstructure</code> See bandstructure struct</li><li><code>hasband::Bool</code> does this object have a band structure, usually <code>true</code></li><li><code>hasham::Bool</code> not used, always <code>false</code></li><li><code>prefix::String</code>  A string has a name used to find output files.</li><li><code>outdir::String</code> Directly loaded from</li><li><code>tot_charge::Float64</code> If charge of unit cell is nonzero</li><li><code>atomize_energy::Float64</code> Atomization energy, relative to non-spin-polarized atoms.</li><li><code>nspin::Int64</code> number of spins (1 = non-sp, 2= spin-polarized)</li><li><code>mag_tot::Float64</code> Total magnetization  = sum<em>i mag</em>i</li><li><code>mag_abs::Float64</code> Absolute magnetization = sum<em>i | mag</em>i |</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L72-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.get_atomize_energy-Tuple{dftout}" href="#ThreeBodyTB.DFToutMod.get_atomize_energy-Tuple{dftout}"><code>ThreeBodyTB.DFToutMod.get_atomize_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_atomize_energy(d::dftout)</code></pre><p>Return atomization energy in current energy units</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L113-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makebs-Tuple{Number, Number, Vararg{Any, 4}}" href="#ThreeBodyTB.DFToutMod.makebs-Tuple{Number, Number, Vararg{Any, 4}}"><code>ThreeBodyTB.DFToutMod.makebs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function makebs(nelec::Number, efermi::Number,  kpoints, kweights,kgrid, vals)</code></pre><p>Constructor for <code>bandstructure</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L213-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makedftout" href="#ThreeBodyTB.DFToutMod.makedftout"><code>ThreeBodyTB.DFToutMod.makedftout</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function makedftout(A, pos, types, energy::Number,energy_smear::Number,  forces, stress, bandstruct=missing; prefix=&quot;PREFIX&quot;, outdir=&quot;TMPDIR&quot;, tot_charge=0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L313-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFToutMod.makedftout" href="#ThreeBodyTB.DFToutMod.makedftout"><code>ThreeBodyTB.DFToutMod.makedftout</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function makedftout(crys::crystal, energy::Number, energy_smear::Number,  forces, stress, bandstruct=missing; prefix=&quot;PREFIX&quot;, outdir=&quot;TMPDIR&quot;, tot_charge=0.0)</code></pre><p>Constructor for dftout. Usually called by function that loads DFT output files, not called directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/DFToutMod.jl#L266-L270">source</a></section></article><h2 id="DFT"><a class="docs-heading-anchor" href="#DFT">DFT</a><a id="DFT-1"></a><a class="docs-heading-anchor-permalink" href="#DFT" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFT" href="#ThreeBodyTB.DFT"><code>ThreeBodyTB.DFT</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module DFT</code></pre><p>This is the generic DFT interface. Only QE is currently implemented however.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L727-L731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.DFT.runSCF-Tuple{crystal}" href="#ThreeBodyTB.DFT.runSCF-Tuple{crystal}"><code>ThreeBodyTB.DFT.runSCF</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function runSCF(crys::crystal; inputstr=missing, prefix=missing, tmpdir=&quot;./&quot;, directory=&quot;./&quot;, functional=&quot;PBESOL&quot;, wannier=0, nprocs=1, code=&quot;QE&quot;, skip=false, calculation=&quot;scf&quot;, dofree=&quot;all&quot;, tot_charge = 0.0, smearing = missing, magnetic=false, cleanup=false, use_backup=false)</code></pre><p>Workflow for generic DFT SCF calculation. <code>code</code> can only by &quot;QE&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L744-L748">source</a></section></article><h2 id="QE"><a class="docs-heading-anchor" href="#QE">QE</a><a id="QE-1"></a><a class="docs-heading-anchor-permalink" href="#QE" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE" href="#ThreeBodyTB.QE"><code>ThreeBodyTB.QE</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module QE</code></pre><p>Module for running Quantum Espresso. Generic DFT version below.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.doclean-Tuple{Any}" href="#ThreeBodyTB.QE.doclean-Tuple{Any}"><code>ThreeBodyTB.QE.doclean</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function doclean(d)</code></pre><p>Clean up wavefunctions in directory <code>d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L199-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML-Tuple{Any}" href="#ThreeBodyTB.QE.loadXML-Tuple{Any}"><code>ThreeBodyTB.QE.loadXML</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function loadXML(savedir)</code></pre><p>Load a QE SCF DFT calculation into a <code>dftout</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L511-L515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML_bs-Tuple{Any}" href="#ThreeBodyTB.QE.loadXML_bs-Tuple{Any}"><code>ThreeBodyTB.QE.loadXML_bs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function loadXML_bs(savedir::String)</code></pre><p>Load <code>bandstructure</code> from QE xml file that was converted to a dict already</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L650-L654">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.loadXML_bs-Tuple{String}" href="#ThreeBodyTB.QE.loadXML_bs-Tuple{String}"><code>ThreeBodyTB.QE.loadXML_bs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function loadXML_bs(savedir::String)</code></pre><p>Load <code>bandstructure</code> from QE xml file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L636-L640">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.make_commands" href="#ThreeBodyTB.QE.make_commands"><code>ThreeBodyTB.QE.make_commands</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function make_commands(nprocs=1)</code></pre><p>Returns a dictionary with command lines to call external programs on the command line nprocs is the number of processors for parallel execution Needs to be changed for you specfic program locations  and mpi commands (if any)</p><p>This needs to be edited to actually run QE yourself. Running wannier90 is optional, not part of current code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Commands.jl#L8-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.makedict-Tuple{Any}" href="#ThreeBodyTB.QE.makedict-Tuple{Any}"><code>ThreeBodyTB.QE.makedict</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function makedict(savedir)</p><p>Load a data-file-schema.xml as julia dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L483-L487">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.runSCF" href="#ThreeBodyTB.QE.runSCF"><code>ThreeBodyTB.QE.runSCF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function runSCF(crys::crystal, inputstr=missing, prefix=missing, tmpdir=&quot;./&quot;, directory=&quot;./&quot;, functional=&quot;PBESOL&quot;, wannier=0, nprocs=1, skip=false, calculation=&quot;scf&quot;, dofree=&quot;all&quot;, tot_charge = 0.0, smearing = 0.01, magnetic=false, cleanup=false, use_backup=false)</code></pre><p>Workflow for doing SCF DFT calculation on <code>crys</code></p><p>Return <code>dftout</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L84-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.QE.run_pwscf" href="#ThreeBodyTB.QE.run_pwscf"><code>ThreeBodyTB.QE.run_pwscf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function run_pwscf(inputstr, outputstr, nprocs=1, directory=&quot;./&quot;, use_backup=false)</code></pre><p>Run the pw.x code from QE on <code>inputstr</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/RunDFT.jl#L38-L42">source</a></section></article><h2 id="Ewald"><a class="docs-heading-anchor" href="#Ewald">Ewald</a><a id="Ewald-1"></a><a class="docs-heading-anchor-permalink" href="#Ewald" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald" href="#ThreeBodyTB.Ewald"><code>ThreeBodyTB.Ewald</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module Ewald</code></pre><p>Module for electrostatic preperation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.electrostatics_getgamma-Tuple{crystal}" href="#ThreeBodyTB.Ewald.electrostatics_getgamma-Tuple{crystal}"><code>ThreeBodyTB.Ewald.electrostatics_getgamma</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function electrostatics_getgamma(crys::crystal;  kappa=missing, noU=false, onlyU=false, screening = 1.0)</code></pre><p>Main function. Does Ewald calculation on <code>crys</code>. Returns <code>gamma</code>, which is used in scf calculation. This is only run once for a given <code>tb_crys</code> object and stored.</p><ul><li><code>kappa</code> is the splitting parameter between real/k-space in Ewald calculation. Will estimate best one if not provided.</li><li><code>noU=false</code> for testing only</li><li><code>onlyU=false</code> for testing only</li><li><code>screening=1.0</code> Not used. Purpose is to reduce U values for values &lt; 1.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L65-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.estimate_best_kappa-Tuple{Any}" href="#ThreeBodyTB.Ewald.estimate_best_kappa-Tuple{Any}"><code>ThreeBodyTB.Ewald.estimate_best_kappa</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function estimate_best_kappa(A)</code></pre><p>Estimate best value of <code>kappa</code> for Ewald sum. Shouldn&#39;t effect final value, only calculation speed. There is probably a better way to do this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L590-L596">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.getU-Tuple{Any}" href="#ThreeBodyTB.Ewald.getU-Tuple{Any}"><code>ThreeBodyTB.Ewald.getU</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function getU(types)</p><p>Get values of <code>U</code> from <code>Atomdata</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.get_onsite-Tuple{crystal, Vector{Float64}}" href="#ThreeBodyTB.Ewald.get_onsite-Tuple{crystal, Vector{Float64}}"><code>ThreeBodyTB.Ewald.get_onsite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_onsite(crys::crystal, U::Array{Float64,1})</code></pre><p>return Onsite terms, Coulumb <code>U</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.k_space" href="#ThreeBodyTB.Ewald.k_space"><code>ThreeBodyTB.Ewald.k_space</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function k_space(crys::crystal, kappa, starting_size_kspace=2)</code></pre><p>K-space Ewald sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L643-L647">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.k_space_LV" href="#ThreeBodyTB.Ewald.k_space_LV"><code>ThreeBodyTB.Ewald.k_space_LV</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function k_space(crys::crystal, kappa, starting_size_kspace=2)</code></pre><p>K-space Ewald sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L756-L760">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Ewald.real_space" href="#ThreeBodyTB.Ewald.real_space"><code>ThreeBodyTB.Ewald.real_space</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function real_space(crys::crystal, kappa::Float64, U::Array{Float64}, starting_size_rspace=2)</code></pre><p>Real-space Ewald sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Ewald.jl#L209-L213">source</a></section></article><h2 id="FitTB"><a class="docs-heading-anchor" href="#FitTB">FitTB</a><a id="FitTB-1"></a><a class="docs-heading-anchor-permalink" href="#FitTB" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fitting(list_of_tbcs; kpoints = missing,  atoms_to_fit=missing, fit_threebody=true, fit_threebody_onsite=true, do_plot = true)</code></pre><p>Used for simple linear fitting of coefficients. Interface for more complicated fitting.</p><ul><li><code>list_of_tbcs</code> - List of <code>tbc_crys</code> or tbc<em>crys</em>k` objects to fit to.</li><li><code>dft_list</code> - for kspace fitting, use </li><li><code>fit_threebody=true</code> - Fit threebody coefficients. Sometimes <code>false</code> for testing, but <code>true</code> for production.</li><li><code>fit_threebody_onsite=true</code> - Fit threebody onsite coefficients. See above.</li><li><code>do_plot=false</code> - show simple plot comparing coefficients to tbc reference.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L81-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting_linear-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting_linear-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting_linear</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fitting_linear(list_of_tbcs; kpoints = missing, dft_list = missing,  fit_threebody=true, fit_threebody_onsite=true, do_plot = false, starting_database=missing, mode=:kspace, return_database=true, NLIM=100, refit_database=missing)</code></pre><p>Linear fitting (not recursive). Used as starting point of recursive fitting.</p><p><strong>Arguments.</strong></p><ul><li><code>list_of_tbcs</code> The main data to fit to. Consists of a list of <code>tb_crys</code> or <code>tb_crys_kspace</code> objects.</li><li><code>kpoints = missing</code> Kpoints to do fitting to in k-space. Usually, this is not used, see below.</li><li><code>dft_list = missing</code> List of <code>dftout</code> objects. Normally, we get symmetry reduced k-grids from these objects.</li><li><code>fit_threebody=true</code> Fit three body coefficients. Yes for production runs.</li><li><code>fit_threebody_onsite=true</code> Fit 3body onsite coefficients. Yes for production runs.</li><li><code>do_plot = false</code> Make a plot to assess fitting. </li><li><code>starting_database=missing</code> Use a database dict with some of the coefficents already fit and fixed.</li><li><code>mode=:kspace</code> Fit in either <code>:kspace</code> or <code>:rspace</code>. Can only use r-space if using only <code>tbc_crys</code> real-space objects to fit to. <code>:kspace</code> is normal.</li><li><code>return_database=true</code> Return the final database. For use when called by other functions.</li><li><code>NLIM=100</code> Largest number of k-points per structure. Set to smaller numbers to make code go faster / reduce memory, but may be less accurate.</li><li><code>refit_database=missing</code> starting point for coefficients we are fitting. Usually not used, as it doesn&#39;t always speed things up in practice. Something may not work about this option.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L685-L703">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.do_fitting_recursive-Tuple{Any}" href="#ThreeBodyTB.FitTB.do_fitting_recursive-Tuple{Any}"><code>ThreeBodyTB.FitTB.do_fitting_recursive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fitting_recursive(list_of_tbcs ; weights_list = missing, dft_list=missing, X_cv = missing, kpoints = [0 0 0; 0 0 0.5; 0 0.5 0.5; 0.5 0.5 0.5], starting_database = missing,  update_all = false, fit_threebody=true, fit_threebody_onsite=true, do_plot = false, energy_weight = missing, rs_weight=missing,ks_weight=missing, niters=50, lambda=0.0, leave_one_out=false, prepare_data = missing, RW_PARAM=0.0, NLIM = 100, refit_database = missing, start_small = false)</code></pre><p>This is the primary function for fitting. Uses the self-consistent linear fitting algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>list_of_tbcs</code> List of <code>tbc_crys</code> or <code>tbc_crys_kspace</code> object to fit to.</li><li><code>weights_list = missing</code> relative weights of different tbc objects in fitting code.</li><li><code>dft_list=missing</code> List of <code>dftout</code> objects used to get symmetry-reduced kpoint lists / weights to use in kspace fitting.</li><li><code>kpoints = [0 0 0; 0 0 0.5; 0 0.5 0.5; 0.5 0.5 0.5]</code> alternate way of setting k-points, not usually used.</li><li><code>starting_database = missing</code> If using already fit coefficents for some of the atoms, from another calculation, include that database dict here.</li><li><code>update_all = false</code> If update<em>all is true, then we refit the starting coefficients from `starting</em>database<code>. Normally</code>false` except for testing.</li><li><code>fit_threebody=true</code> Fit 3body intersite coefficents. <code>true</code> for production runs.</li><li><code>fit_threebody_onsite=true</code> Fit 3body onsite coefficents. <code>true</code> for production runs.</li><li><code>do_plot = false</code> make plot for the linear fit.</li><li><code>energy_weight = missing</code> Weighting for the total energy terms in the fit.</li><li><code>rs_weight=missing</code> Real space hamiltonian matrix els weighting. zero for pure k-space fit.</li><li><code>ks_weight=missing</code>  K-space hamiltonian matrix els weighting. Set to zero to ignore hamiltonian matrix els and only fit to band structure.</li><li><code>niters=50</code> Maximum number of iterations.</li><li><code>lambda=0.0</code>  If greater than zero, include a simple ridge regression with this lambda value. Usually zero.</li><li><code>leave_one_out=false</code>  Leave-one-out cross-validation. Too slow to be very useful.</li><li><code>prepare_data = missing</code> Rarely used option to reuse previous linear fitting.</li><li><code>RW_PARAM=0.0</code> Weighting of non-occupied bands in fit.</li><li><code>NLIM = 100</code> Maximum k-points per structure. Smaller for faster but less accurate fit that uses less memory.</li><li><code>refit_database = missing</code> Option to include starting data. Rarely used.</li><li><code>start_small = false</code> When fitting only 3body data, setting this to true will start the 3body terms with very small values, which can improve convergence. Not useful if also fitting 2body terms.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L1401-L1428">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.extract_database-NTuple{6, Any}" href="#ThreeBodyTB.FitTB.extract_database-NTuple{6, Any}"><code>ThreeBodyTB.FitTB.extract_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function extract_database(database_old,nh,ns, KEYS, HIND, SIND)</code></pre><p>If we are using fixed prefit coefficients, we have to get them in the same form as our current fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L1016-L1020">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.fourierspace-NTuple{13, Any}" href="#ThreeBodyTB.FitTB.fourierspace-NTuple{13, Any}"><code>ThreeBodyTB.FitTB.fourierspace</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function fourierspace(tbc, kpoints, X_H, X_S, Y_H, Y_S, Xhc, Xsc, rind, Rvec, INDVec, h_on, ind_convert)</code></pre><p>Do analytic fourier transform of real space fitting matrices into kspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L1072-L1076">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.get_k-Tuple{Any, Any, Any}" href="#ThreeBodyTB.FitTB.get_k-Tuple{Any, Any, Any}"><code>ThreeBodyTB.FitTB.get_k</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_k(dft_list, ncalc; NLIM = 100)</code></pre><p>Decide which k-points to include in fitting, as we limit the total number to <code>NLIM</code> or less per structure</p><p>Uses some randomness, but puts high symmetry points at front of line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L1264-L1270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.hermetian_index-Tuple{Int64, Int64, Int64}" href="#ThreeBodyTB.FitTB.hermetian_index-Tuple{Int64, Int64, Int64}"><code>ThreeBodyTB.FitTB.hermetian_index</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function hermetian_index(i::Int64,j::Int64,nwan::Int64)</code></pre><p>This is used to reduce memory by only keeping track of independet coefficients of Hermetian matrices, which is nearly a factor of 2 reduction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L1249-L1253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.make_database-NTuple{7, Any}" href="#ThreeBodyTB.FitTB.make_database-NTuple{7, Any}"><code>ThreeBodyTB.FitTB.make_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function make_database(ch, cs,  KEYS, HIND, SIND, DMIN_TYPES, DMIN_TYPES3; scf=false, starting_database=missing, tbc_list=missing)</code></pre><p>Construct the <code>coefs</code> and database from final results of fitting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L863-L867">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.FitTB.prepare_for_fitting-Tuple{Any}" href="#ThreeBodyTB.FitTB.prepare_for_fitting-Tuple{Any}"><code>ThreeBodyTB.FitTB.prepare_for_fitting</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function prepare_for_fitting(list_of_tbcs; kpoints = missing, dft_list = missing, fit_threebody=false, fit_threebody_onsite=false, starting_database=missing, refit_database=missing)</code></pre><p>Make lots of preperations for fitting. Moves things around, put stuff in materices, etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/FitTB_laguerre.jl#L99-L103">source</a></section></article><h2 id="Force_Stress"><a class="docs-heading-anchor" href="#Force_Stress">Force_Stress</a><a id="Force_Stress-1"></a><a class="docs-heading-anchor-permalink" href="#Force_Stress" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress" href="#ThreeBodyTB.Force_Stress"><code>ThreeBodyTB.Force_Stress</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module Force_Stress</code></pre><p>Module for calculating force and stress</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.finite_diff-Tuple{crystal, Any, Any, Any}" href="#ThreeBodyTB.Force_Stress.finite_diff-Tuple{crystal, Any, Any, Any}"><code>ThreeBodyTB.Force_Stress.finite_diff</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function finite_diff(crys::crystal, database, ind1, ind2; stress_mode=false, step = 0.0002, smearing = 0.01, grid = missing)</code></pre><p>Finite differences force/stress, for testing.</p><p><strong>Arguments</strong></p><ul><li><code>crys::crystal</code> Crystal structure</li><li><code>database</code> Database of fitting coefficents.</li><li><code>ind1</code>  atom index for first stress index</li><li><code>ind2</code> cartesian index or second stress index</li><li><code>stress_mode=false</code> true for stress, otherwise force.</li><li><code>step = 0.0002</code> step_size for finite steps.</li><li><code>smearing = 0.01</code> smearing energy</li><li><code>grid = missing</code> kpoint grid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L311-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{crystal, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress-Tuple{crystal, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress(crys::crystal, database; smearing = 0.01, grid = missing)</code></pre><p>Get force and stress, non-fft algorithm. Generally use the fft algorithm.</p><p><code>return energy_tot,  f_cart, stress</code></p><p>Returns Ryd units. Generally users should use the <code>scf_energy_force_stress</code> function</p><p>Uses automatic differentation for gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L70-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_NOFFT-Tuple{tb_crys, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_NOFFT-Tuple{tb_crys, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_NOFFT</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress(crys::crystal, database; smearing = 0.01, grid = missing)</code></pre><p>Get force and stress, non-fft algorithm</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_fft-Tuple{tb_crys, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_fft-Tuple{tb_crys, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_fft</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress_fft(tbc::tb_crys, database; do_scf=false, smearing = 0.01, grid = missing, e_den0=missing, vv = missing)</code></pre><p>Calculate energy/force/stress using fft algorithm. Users should use <code>scf_energy_force_stress</code>, which calls this. Uses automatic differentation for jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L521-L525">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV-Tuple{tb_crys, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV-Tuple{tb_crys, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress_fft(tbc::tb_crys, database; do_scf=false, smearing = 0.01, grid = missing, e_den0=missing, vv = missing)</code></pre><p>Calculate energy/force/stress using fft algorithm. Users should use <code>scf_energy_force_stress</code>, which calls this. Uses automatic differentation for jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L874-L878">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym-Tuple{tb_crys, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym-Tuple{tb_crys, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress_fft(tbc::tb_crys, database; do_scf=false, smearing = 0.01, grid = missing, e_den0=missing, vv = missing)</code></pre><p>Calculate energy/force/stress using fft algorithm. Users should use <code>scf_energy_force_stress</code>, which calls this. Uses automatic differentation for jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress_sym.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym_SINGLE-Tuple{ThreeBodyTB.TB.tb_crys_sparse, Any}" href="#ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym_SINGLE-Tuple{ThreeBodyTB.TB.tb_crys_sparse, Any}"><code>ThreeBodyTB.Force_Stress.get_energy_force_stress_fft_LV_sym_SINGLE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_energy_force_stress_fft_LV_sym_SINGLE(tbc::tb_crys_sparse)</code></pre><p>Main sparse matrix force/stress calculator. Should be faster for large systems, due to faster matrix/vector and matrix/matrix multiply (assuming sparscity). Also requires much less memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress_sparse.jl#L95-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.safe_mode_energy-Tuple{crystal, Any}" href="#ThreeBodyTB.Force_Stress.safe_mode_energy-Tuple{crystal, Any}"><code>ThreeBodyTB.Force_Stress.safe_mode_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function safe_mode_energy(crys::crystal, database; var_type=Float64)</code></pre><p>Relaxation can accidently lead to very small atom-atom distances during the relaxation precedure if too large of step is taken. This function is a repulsive energy function at short range to make sure the relaxtion doesn&#39;t get stuck at very short distances where the fitting doesn&#39;t apply.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress.jl#L431-L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Force_Stress.sparsify_jac-NTuple{4, Any}" href="#ThreeBodyTB.Force_Stress.sparsify_jac-NTuple{4, Any}"><code>ThreeBodyTB.Force_Stress.sparsify_jac</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function sparsify_jac(jac, INDH, INDS, nwan)</code></pre><p>A pain of using ForwardDiff.jacobian on a function that returns a sparse matrix Hamiltonian is that ForwardDiff wants a dense return. So we have to  do a lot of work returning a dense matrix version of the sparse matrix and the index of the non-zero entries. We then sparsify it here.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Force_Stress_sparse.jl#L60-L65">source</a></section></article><h2 id="ManageDatabase"><a class="docs-heading-anchor" href="#ManageDatabase">ManageDatabase</a><a id="ManageDatabase-1"></a><a class="docs-heading-anchor-permalink" href="#ManageDatabase" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase" href="#ThreeBodyTB.ManageDatabase"><code>ThreeBodyTB.ManageDatabase</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module ManageDatabase</code></pre><p>Module for reading <code>coefs</code> from files and making database as needed for calculations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ManageDatabase.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.add_to_database-Tuple{Set}" href="#ThreeBodyTB.ManageDatabase.add_to_database-Tuple{Set}"><code>ThreeBodyTB.ManageDatabase.add_to_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function add_to_database(s::Set)</code></pre><p>Load elements or twobody terms from precalcuated <code>coefs</code> from files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ManageDatabase.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.clear_database-Tuple{}" href="#ThreeBodyTB.ManageDatabase.clear_database-Tuple{}"><code>ThreeBodyTB.ManageDatabase.clear_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function clear_database()</code></pre><p>Remove loaded databasea</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ManageDatabase.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.prepare_database-Tuple{Any}" href="#ThreeBodyTB.ManageDatabase.prepare_database-Tuple{Any}"><code>ThreeBodyTB.ManageDatabase.prepare_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function prepare_database(at_list)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ManageDatabase.jl#L60-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ManageDatabase.prepare_database-Tuple{crystal}" href="#ThreeBodyTB.ManageDatabase.prepare_database-Tuple{crystal}"><code>ThreeBodyTB.ManageDatabase.prepare_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function prepare_database(c::crystal)</code></pre><p>Get ready database of precalculated <code>coefs</code> for <code>crystal</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ManageDatabase.jl#L27-L31">source</a></section></article><h2 id="SCF"><a class="docs-heading-anchor" href="#SCF">SCF</a><a id="SCF-1"></a><a class="docs-heading-anchor-permalink" href="#SCF" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF" href="#ThreeBodyTB.SCF"><code>ThreeBodyTB.SCF</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module SCF</code></pre><p>Module for self-consistent field calculations for TB objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{Any, Any, Any}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{Any, Any, Any}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function remove_scf_from_tbc(hk3, sk3, tbc; smearing=0.01, e_den = missing)</code></pre><p>This function takes a hk3, sk3 set of hamiltonian / overlap that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L1347-L1352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{tb_crys_kspace}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{tb_crys_kspace}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function remove_scf_from_tbc(tbcK::tb_crys_kspace; smearing=0.01, e_den = missing)</code></pre><p>This function takes a <code>tbc_crys_kspace</code> object that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L1157-L1162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{tb_crys}" href="#ThreeBodyTB.SCF.remove_scf_from_tbc-Tuple{tb_crys}"><code>ThreeBodyTB.SCF.remove_scf_from_tbc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function remove_scf_from_tbc(tbc::tb_crys; smearing=0.01, grid = missing, e_den = missing)</code></pre><p>This function takes a <code>tbc_crys</code> object that does not require scf and adjusts it  so that it does require scf, but gives the same energy and band structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L1291-L1296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.TB.tb_crys_sparse}" href="#ThreeBodyTB.SCF.scf_energy-Tuple{ThreeBodyTB.TB.tb_crys_sparse}"><code>ThreeBodyTB.SCF.scf_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function scf_energy(tbc::tb_crys_sparse)</code></pre><p>Sparse matrix implmentation of self-consistent field. Uses dense eigen routines, but sparse matrix mulitplication. Repeats a lot of code currently. TODO : refactor with less waste.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF_sparse.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.scf_energy-Tuple{crystal, Dict}" href="#ThreeBodyTB.SCF.scf_energy-Tuple{crystal, Dict}"><code>ThreeBodyTB.SCF.scf_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function scf_energy(c::crystal, database::Dict; smearing=0.01, grid = missing, conv_thr = 1e-5, iters = 75, mix = -1.0, mixing_mode=:pulay, verbose=true)</code></pre><p>Run scf calculation of <code>c::crystal</code>, using <code>database</code> of <code>coefs</code>. The main user version is <code>scf_energy</code> in ThreeBodyTB, which calls this one.</p><ul><li><code>smearing</code> is smearing energy in Ryd.</li><li><code>grid</code> is k-point grid (gamma centered MP), will use default.</li><li><code>conv_thr</code> convergence threshold in Ryd.</li><li><code>iters</code> maximum iterations for first attempt</li><li><code>mix=-1.0</code> default is choose mixing for you. Otherwise, set between <code>0.0</code> and <code>1.0</code></li><li><code>mixing_mode=:DIIS</code> default using Pulay mixing (DIIS). Any other input uses simple mixing.</li><li><code>verbose=true</code> verbosity level.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L69-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.SCF.scf_energy-Tuple{tb_crys}" href="#ThreeBodyTB.SCF.scf_energy-Tuple{tb_crys}"><code>ThreeBodyTB.SCF.scf_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function scf_energy(tbc::tb_crys; smearing=0.01, grid = missing, e_den0 = missing, conv_thr = 1e-5, iters = 100, mix = -1.0, mixing_mode=:pulay, verbose=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/SCF.jl#L118-L120">source</a></section></article><h2 id="Utilty"><a class="docs-heading-anchor" href="#Utilty">Utilty</a><a id="Utilty-1"></a><a class="docs-heading-anchor-permalink" href="#Utilty" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Utility" href="#ThreeBodyTB.Utility"><code>ThreeBodyTB.Utility</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module Utility</code></pre><p>Some useful functions, mostly for converting stuff and loading files and reshaping stuff.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Utility.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Utility.inv_reshape_vec-Tuple{Any, Any, Any}" href="#ThreeBodyTB.Utility.inv_reshape_vec-Tuple{Any, Any, Any}"><code>ThreeBodyTB.Utility.inv_reshape_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function inv_reshape_vec(x, strain, nat; strain_mode=true)</code></pre><p>The force and relax algorithms from outside codes take in vectors, not <code>crystal</code> &#39;s. So we have to reshape vectors to and from <code>crystals</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Utility.jl#L79-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Utility.reshape_vec-Tuple{Any, Any}" href="#ThreeBodyTB.Utility.reshape_vec-Tuple{Any, Any}"><code>ThreeBodyTB.Utility.reshape_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function reshape_vec(x, nat; strain_mode=false)</code></pre><p>The force and relax algorithms from outside codes take in vectors, not <code>crystal</code> &#39;s. So we have to reshape vectors to and from <code>crystals</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Utility.jl#L14-L19">source</a></section></article><h2 id="Symmetry"><a class="docs-heading-anchor" href="#Symmetry">Symmetry</a><a id="Symmetry-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetry" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Symmetry.get_kpath_sym-Tuple{crystal}" href="#ThreeBodyTB.Symmetry.get_kpath_sym-Tuple{crystal}"><code>ThreeBodyTB.Symmetry.get_kpath_sym</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_kpath_sym(c::crystal; sym_prec = 5e-4, magmoms = missing)</code></pre><p>The group-theory based k-point path. Uses Spglib.jl for symmetry and largely follows the conventions of &#39;High-throughput electronic band structure calculations: Challenges and tools&#39; - Setyawan and Curtarolo Comp Mater Sci 2010</p><p>Implementation based on jarvis-tools by C. Choudhary (https://github.com/usnistgov/jarvis/blob/master/jarvis/core/kpoints.py and https://github.com/usnistgov/jarvis/blob/master/jarvis/analysis/structure/spacegroup.py )</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Symmetry.jl#L368-L382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Symmetry.get_standard_crys-Tuple{crystal}" href="#ThreeBodyTB.Symmetry.get_standard_crys-Tuple{crystal}"><code>ThreeBodyTB.Symmetry.get_standard_crys</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_standard_crys(c::crystal; sym_prec = 5e-4, magmoms=missing, to_primitive=true)</code></pre><p>Return standardized crystal structure, per spglib convention. Check if space-group is correct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Symmetry.jl#L320-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Symmetry.get_symmetry-Tuple{crystal}" href="#ThreeBodyTB.Symmetry.get_symmetry-Tuple{crystal}"><code>ThreeBodyTB.Symmetry.get_symmetry</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function get_symmetry(c::crystal; verbose=true, sym_prec = 5e-4, magmoms=missing)</code></pre><p>Return space group number, print other symmetry information if <code>verbose=true</code>. Based on Spglib.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Symmetry.jl#L263-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Symmetry.kassemble-Tuple{Any, Any}" href="#ThreeBodyTB.Symmetry.kassemble-Tuple{Any, Any}"><code>ThreeBodyTB.Symmetry.kassemble</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function kassemble(kdict, names)</code></pre><p>Helper function, converts names to k-points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Symmetry.jl#L955-L959">source</a></section></article><h2 id="Classical"><a class="docs-heading-anchor" href="#Classical">Classical</a><a id="Classical-1"></a><a class="docs-heading-anchor-permalink" href="#Classical" title="Permalink"></a></h2><p>-experimental</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical" href="#ThreeBodyTB.Classical"><code>ThreeBodyTB.Classical</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module Classical</code></pre><p>Run a CLASSICAL model based on similar computational machinery to the TB3 model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.coefs_cl" href="#ThreeBodyTB.Classical.coefs_cl"><code>ThreeBodyTB.Classical.coefs_cl</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct coefs_cl</code></pre><p>Hold the classical coefficients for 2body or 3body interactions and EAM interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L103-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.calc_energy_cl-Tuple{crystal}" href="#ThreeBodyTB.Classical.calc_energy_cl-Tuple{crystal}"><code>ThreeBodyTB.Classical.calc_energy_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calc_energy_cl(crys::crystal</code></pre><p>Main function for classical energy calculation from crystal structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L881-L885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.core_4_cl_laguerre_fast_fourbdy_cl!-NTuple{12, Any}" href="#ThreeBodyTB.Classical.core_4_cl_laguerre_fast_fourbdy_cl!-NTuple{12, Any}"><code>ThreeBodyTB.Classical.core_4_cl_laguerre_fast_fourbdy_cl!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Four body terms are experimental, may not be supported</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L783-L785">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.energy_force_stress_cl-Tuple{crystal}" href="#ThreeBodyTB.Classical.energy_force_stress_cl-Tuple{crystal}"><code>ThreeBodyTB.Classical.energy_force_stress_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function energy_force_stress_cl(crys::crystal)</code></pre><p>Main function for running classical model. Returns energy/force/stress from crystal structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L428-L432">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.make_coefs_cl-Tuple{Any, Any}" href="#ThreeBodyTB.Classical.make_coefs_cl-Tuple{Any, Any}"><code>ThreeBodyTB.Classical.make_coefs_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function make_coefs_cl(at_list, dim)</code></pre><p>Constructor for <code>coefs</code>. Can create coefs filled with ones for testing purposes.</p><p>See <code>coefs_cl</code> to understand arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L256-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.read_coefs_cl" href="#ThreeBodyTB.Classical.read_coefs_cl"><code>ThreeBodyTB.Classical.read_coefs_cl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function read_coefs_cl(filename, directory = missing)</code></pre><p>Read Classical <code>coefs_cl</code> from filename. Can read gzipped files directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.Classical.write_coefs_cl-Tuple{Any, ThreeBodyTB.Classical.coefs_cl}" href="#ThreeBodyTB.Classical.write_coefs_cl-Tuple{Any, ThreeBodyTB.Classical.coefs_cl}"><code>ThreeBodyTB.Classical.write_coefs_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function write_coefs_cl(filename, co::coefs; compress=true)</code></pre><p>Write <code>coefs_cl</code> to an file xml. Compress uses gzip. See <code>read_coefs_cl</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/Classical.jl#L125-L129">source</a></section></article><h2 id="ClassicalFit"><a class="docs-heading-anchor" href="#ClassicalFit">ClassicalFit</a><a id="ClassicalFit-1"></a><a class="docs-heading-anchor-permalink" href="#ClassicalFit" title="Permalink"></a></h2><p>-experimental</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ClassicalFit" href="#ThreeBodyTB.ClassicalFit"><code>ThreeBodyTB.ClassicalFit</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">module CalcTB</code></pre><p>Create TB matrix sets from coefficients, or prepare to fit the coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ClassicalFit.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ClassicalFit.do_fit_cl-Tuple{Any}" href="#ThreeBodyTB.ClassicalFit.do_fit_cl-Tuple{Any}"><code>ThreeBodyTB.ClassicalFit.do_fit_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fit_cl(DFT)</code></pre><p>For fitting the classical model to a specific set of DFT calculations in the list <code>DFT</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ClassicalFit.jl#L180-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ClassicalFit.do_fit_cl-Tuple{Vector{crystal}}" href="#ThreeBodyTB.ClassicalFit.do_fit_cl-Tuple{Vector{crystal}}"><code>ThreeBodyTB.ClassicalFit.do_fit_cl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fit_cl(CRYS::Array{crystal,1})</code></pre><p>Does the main fitting for CLASSICAL MODEL</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ClassicalFit.jl#L305-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ClassicalFit.do_fit_cl_RECURSIVE-Tuple{Any}" href="#ThreeBodyTB.ClassicalFit.do_fit_cl_RECURSIVE-Tuple{Any}"><code>ThreeBodyTB.ClassicalFit.do_fit_cl_RECURSIVE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function do_fit_cl_RECURSIVE(DFT_start)</code></pre><p>Main CLASSICAL fitting routine. Runs DFT in recursive active-learning styel framework. For fitting classical energy model with basis of Laguerre polynomials times exponentials similar to the TB3 model. Can consider 2 and 3 body terms as well as an EAM (embedded atom model) style term. Experimental.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ClassicalFit.jl#L127-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ThreeBodyTB.ClassicalFit.kfold-Tuple{Any, Any}" href="#ThreeBodyTB.ClassicalFit.kfold-Tuple{Any, Any}"><code>ThreeBodyTB.ClassicalFit.kfold</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function kfold(L, n)</code></pre><p>Helper function for kfold cross-validation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/ThreeBodyTB.jl/blob/bf119cdb52de7004c70beb9d9b21e9cf3fcf648f/src/ClassicalFit.jl#L85-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../compile/">« Compile/Python</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 1 March 2024 21:55">Friday 1 March 2024</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
